import{b as re,l as de}from"./common-1efebc04.js";import{an as ce,r as o,d as ve,i as fe,v as Q,e as X,R as me,a3 as pe,o as r,j as d,a as u,h as _,w as g,b as k,t as R,u as S,l as W,F as h,k as b,aU as Y,al as _e,p as Se,n as he,_ as be}from"./index-195a6a18.js";import{c as x}from"./VDialog-039bd874.js";import{V as U}from"./VCheckbox-aa2e983a.js";const ye=ce("filterd",()=>{const y=o([]),V=o([]),a=o(!0),A=o([]),F=o([]),O=o([]);return{tempSelectedCharacters:y,tempSelectedRare:V,isFirst:a,tempSelectedType:A,tempSelectedAttr:F,tempSelectedEffects:O}}),le=y=>(Se("data-v-24d1b79a"),y=y(),he(),y),Me={class:"modal-background",ref:"modalContainer"},ge={class:"feature-select-all-container"},ke={class:"feature-items"},Re=le(()=>u("hr",{class:"rare-divider"},null,-1)),We={class:"display-block"},we={class:"character-list-wrapper"},Ce={class:"character-select-all-container"},Ue={class:"character-items"},Ve=["onClick"],Ae=["src","alt"],Fe=le(()=>u("hr",{class:"rare-divider"},null,-1)),Oe={class:"feature-select-all-container"},Pe={class:"feature-items"},$e={class:"button-container"},Z=50,ee=10,Be=ve({__name:"FilterModal",emits:["close"],setup(y,{emit:V}){const{t:a}=fe(),A=re(),{characters:F}=Q(A),O=ye(),{tempSelectedCharacters:P,tempSelectedRare:$,tempSelectedType:B,tempSelectedAttr:E,tempSelectedEffects:T,isFirst:G}=Q(O),i=o([]),v=o([]),p=o([]),c=o([]),f=o([]),te=V,I=o(0),L=o({}),ae=o({"--icon-size":`${Z}px`,"--gap-size":`${ee}px`}),j=["SSR","SR","R"],H=X(()=>[{name:a("filterModal.balance"),value:"バランス"},{name:a("filterModal.defence"),value:"ディフェンス"},{name:a("filterModal.attack"),value:"アタック"}]),K=X(()=>[{name:a("filterModal.fire"),value:"火"},{name:a("filterModal.water"),value:"水"},{name:a("filterModal.flora"),value:"木"},{name:a("filterModal.cosmic"),value:"無"}]),w=[{name:a("filterModal.power_boost"),value:"ATKUP"},{name:a("filterModal.damage_boost"),value:"ダメージUP"},{name:a("filterModal.critical"),value:"クリティカル"},{name:a("filterModal.element_boost"),value:"属性ダメージUP"},{name:a("filterModal.damage_vulnerability"),value:"被ダメージUP"},{name:a("filterModal.power_cut"),value:"ATKDOWN"},{name:a("filterModal.damage_cut"),value:"ダメージDOWN"},{name:a("filterModal.evasion"),value:"回避"},{name:a("filterModal.element_cut"),value:"属性ダメージDOWN"},{name:a("filterModal.resistence"),value:"被ダメージDOWN"},{name:a("filterModal.hp_restoration"),value:"HP回復"},{name:a("filterModal.hp_regen"),value:"HP継続回復"},{name:a("filterModal.nullifies_blind"),value:"暗闇無効"},{name:a("filterModal.nullifies_curse"),value:"呪い無効"},{name:a("filterModal.nullifies_freeze"),value:"凍結無効"},{name:a("filterModal.debuff_removal"),value:"デバフ解除"},{name:a("filterModal.curse"),value:"呪い"}],M=x.reduce((e,t)=>{const l=t.dorm;return e[l]||(e[l]=[]),e[l].push(t),e},{}),N=()=>{const e=document.querySelector(".display-block");e&&(I.value=e.clientWidth)},q=()=>{N()};me(async()=>{G.value?(i.value=Object.values(M).flat().map(e=>e.name_en),v.value=["SSR","SR","R"],p.value=["バランス","ディフェンス","アタック"],c.value=["火","水","木","無"],f.value=["ATKUP","ダメージUP","クリティカル","属性ダメージUP","被ダメージUP","ATKDOWN","ダメージDOWN","回避","属性ダメージDOWN","被ダメージDOWN","HP回復","HP継続回復","暗闇無効","呪い無効","凍結無効","デバフ解除","呪い"]):(P.value.length>0&&(i.value=[...P.value]),$.value.length>0&&(v.value=[...$.value]),B.value.length>0&&(p.value=[...B.value]),E.value.length>0&&(c.value=[...E.value]),T.value.length>0&&(f.value=[...T.value])),G.value=!1,N(),window.addEventListener("resize",q),L.value=await de(x,e=>e.name_en,"icon/")}),pe(()=>{window.removeEventListener("resize",q)});function se(){P.value=[...i.value],$.value=[...v.value],B.value=[...p.value],E.value=[...c.value],T.value=[...f.value],F.value.forEach(e=>{if(!v.value.includes(e.rare)){e.visible=!1;return}const t=x.find(l=>l.name_ja===e.chara||l.name_en===e.chara);if(!t||!i.value.includes(t.name_en)){e.visible=!1;return}if(!p.value.includes(e.attr)){e.visible=!1;return}if(!c.value.includes(e.magic1atr)&&!c.value.includes(e.magic2atr)&&!c.value.includes(e.magic3atr)){e.visible=!1;return}if(f.value.length===17)e.visible=!0;else if(!f.value.some(s=>e.etc.includes(s))){e.visible=!1;return}}),te("close")}function D(e){if(e==="statusEffects")w.every(l=>f.value.includes(l.value))?f.value=[]:f.value=w.map(l=>l.value);else if(e==="cardAttributes"){const t=["SSR","SR","R"].every(n=>v.value.includes(n)),l=["バランス","ディフェンス","アタック"].every(n=>p.value.includes(n)),s=["火","水","木","無"].every(n=>c.value.includes(n));t&&l&&s?(v.value=[],p.value=[],c.value=[]):(v.value=["SSR","SR","R"],p.value=["バランス","ディフェンス","アタック"],c.value=["火","水","木","無"])}else{const t=M[e]||[];t.every(s=>i.value.includes(s.name_en))?i.value=i.value.filter(s=>!t.some(n=>n.name_en===s)):i.value=[...new Set([...i.value,...t.map(s=>s.name_en)])]}}function z(e){return e==="cardAttributes"?j.every(l=>v.value.includes(l))&&H.value.every(l=>p.value.includes(l.value))&&K.value.every(l=>c.value.includes(l.value)):e==="statusEffects"?w.every(l=>f.value.includes(l.value)):M[e].every(l=>i.value.includes(l.name_en))}function ne(e){i.value=i.value.includes(e)?i.value.filter(t=>t!==e):[...i.value,e]}const ie=e=>64+(Z+10+ee)*e.length+10,ue=e=>({width:e===1?"100%":"50%"}),oe=()=>{const e=[];let t=[],l=0;const s=I.value,n=2;return Object.entries(M).forEach(([m,J])=>{const C=ie(J);C>=s/n?(t.length>0&&(e.push(t),t=[],l=0),e.push([m])):l+C<=s&&t.length<n?(t.push(m),l+=C):(e.push(t),t=[m],l=C)}),t.length>0&&e.push(t),e};return(e,t)=>(r(),d("div",Me,[u("div",ge,[_(W,{small:"",onClick:t[0]||(t[0]=l=>D("cardAttributes"))},{default:g(()=>[k(R(z("cardAttributes")?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:1}),u("div",ke,[(r(),d(h,null,b(j,(l,s)=>u("div",{class:"feature-item",key:`rare-${s}`},[_(U,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=n=>v.value=n),value:l,label:l,"hide-details":""},null,8,["modelValue","value","label"])])),64)),(r(!0),d(h,null,b(H.value,(l,s)=>(r(),d("div",{class:"feature-item",key:`type-${s}`},[_(U,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=n=>p.value=n),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])]))),128)),(r(!0),d(h,null,b(K.value,(l,s)=>(r(),d("div",{class:"feature-item",key:`attr-${s}`},[_(U,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=n=>c.value=n),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])]))),128))])]),Re,u("div",We,[u("div",we,[(r(!0),d(h,null,b(oe(),(l,s)=>(r(),d("div",{key:s,class:"row"},[(r(!0),d(h,null,b(l,n=>(r(),d("div",{key:n,style:Y(ue(l.length)),class:"character-list"},[u("div",Ce,[_(W,{small:"",onClick:m=>D(n)},{default:g(()=>[k(R(z(n)?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:2},1032,["onClick"]),u("div",Ue,[(r(!0),d(h,null,b(S(M)[n],m=>(r(),d("div",{key:m.name_en,class:_e(["character-item",{selected:i.value.includes(m.name_en)}]),onClick:J=>ne(m.name_en),style:Y({...ae.value,opacity:i.value.includes(m.name_en)?1:.5})},[u("img",{src:L.value[m.name_en],alt:m.name_en,class:"character-image"},null,8,Ae)],14,Ve))),128))])])],4))),128))]))),128))])]),Fe,u("div",Oe,[_(W,{small:"",onClick:t[4]||(t[4]=l=>D("statusEffects"))},{default:g(()=>[k(R(z("statusEffects")?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:1}),u("div",Pe,[(r(),d(h,null,b(w,l=>u("div",{key:l.name,class:"feature-item"},[_(U,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=s=>f.value=s),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])])),64))])]),u("div",$e,[_(W,{class:"button",onClick:t[6]||(t[6]=l=>e.$emit("close"))},{default:g(()=>[k(R(e.$t("filterModal.cancel")),1)]),_:1}),_(W,{class:"button apply-button",disabled:i.value.length===0||v.value.length===0,onClick:se},{default:g(()=>[k(R(e.$t("filterModal.submit")),1)]),_:1},8,["disabled"])])],512))}});const xe=be(Be,[["__scopeId","data-v-24d1b79a"]]);export{xe as F};
