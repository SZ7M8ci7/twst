import{C as G,r as P,u as X,V as j,D as J}from"./simulatorStore-CcIdtQi7.js";import{d as K,i as L,r as _,e as n,X as Q,H as W,c as Y,w as u,g as t,a as s,t as c,m as Z,V as y,b8 as ee,b as U,o as ae,_ as te}from"./index-BCT6A5Hy.js";import{V as v,a as C}from"./VRow-Bwg_fO9W.js";import{V as le}from"./VContainer-DFWxPuRL.js";const se={class:"field-label"},ue={class:"field-label"},oe={class:"field-label"},de={class:"table-wrapper"},ne={class:"pa-0"},ie={class:"pa-0"},re={class:"pa-0"},ce={class:"text-nowrap wide-cell pa-0"},ve={class:"mdi mdi-help-circle-outline"},me={class:"pa-0"},pe={class:"pa-0"},be={class:"pa-0"},fe=K({__name:"calcBASIC",props:{selectedAttribute:{}},setup(B){G.register(...P);const{t:f}=L(),m=X(),A=B,x=_(!1),p=[.144,.138,.132,.126,.1],g=_(0),N=_(0),r=_(1.5),I=[{text:"Easy",value:.8},{text:"Normal",value:1},{text:"Hard",value:1.2},{text:"Extra",value:1.5}],o=_({advantage:0,equal:0,disadvantage:0}),F=n(()=>Number(o.value.advantage)+Number(o.value.equal)+Number(o.value.disadvantage)),b=n(()=>Math.max(0,Number(Math.floor((F.value-1)/2+.001).toFixed()))),h=n(()=>Number(g.value)-F.value*4.5),k=n(()=>N.value*3e3),w=n(()=>Number(o.value.advantage)*2e3),q=n(()=>Number(o.value.equal)*500),$=n(()=>Number(o.value.disadvantage)*-1e3),M=n(()=>h.value+k.value+w.value+q.value+$.value),T=n(()=>(M.value*r.value*p[b.value]).toFixed()),V=["#FAD9C8","#FAF2C8","#E9FAC8","#D0FAC8","#C8FAD9"],S=n(()=>[{label:f("basic.damage"),value:Number((h.value*r.value*p[b.value]).toFixed()),color:V[0]},{label:f("basic.duo"),value:Number((k.value*r.value*p[b.value]).toFixed()),color:V[1]},{label:f("basic.numberOfAdvantage"),value:Number((w.value*r.value*p[b.value]).toFixed()),color:V[2]},{label:f("basic.numberOfNeutral"),value:Number((q.value*r.value*p[b.value]).toFixed()),color:V[3]},{label:f("basic.numberOfDisadvantage"),value:Number(($.value*r.value*p[b.value]).toFixed()),color:V[4]}].sort((e,a)=>a.value-e.value)),E=n(()=>({labels:S.value.map(e=>e.label),datasets:[{data:S.value.map(e=>e.value),backgroundColor:S.value.map(e=>e.color)}]}));Q(async()=>{await m.waitForDeckStats(),x.value=!0,W(()=>[m.deckCharacters,A.selectedAttribute,m.isDeckStatsReady],()=>{x.value&&m.isDeckStatsReady&&O()},{deep:!0,immediate:!0})});async function O(){if(x.value)try{const e=A.selectedAttribute||"対全",a=await m.getSafeDeckDamage(e);g.value=Math.floor(a);const l=(m.deckCharacters||[]).filter(d=>(d==null?void 0:d.magic2Power)==="デュオ"&&(d==null?void 0:d.isM2Selected)).length;N.value=l;const i=R();o.value.advantage=i.advantage,o.value.equal=i.equal,o.value.disadvantage=i.disadvantage}catch{g.value=0}}function R(){const e={advantage:0,equal:0,disadvantage:0},a=A.selectedAttribute||"対全",l=a.replace("対","");return(m.deckCharacters||[]).forEach(i=>{if(!(!i||!i.name||i.name===""||i.name==="なし")){for(let d=1;d<=3;d++)if(i[`isM${d}Selected`]){const D=i[`magic${d}Attribute`];a==="対全"?D==="無"?e.equal++:e.advantage++:l==="無"?e.equal++:H(D,l)?e.advantage++:z(D,l)?e.disadvantage++:e.equal++}}}),e}function H(e,a){return{火:"木",水:"火",木:"水"}[e]===a}function z(e,a){return{火:"水",水:"木",木:"火"}[e]===a}return(e,a)=>(ae(),Y(le,{class:"pa-2"},{default:u(()=>[t(C,{class:"ma-0"},{default:u(()=>[t(v,{cols:"12",class:"pa-0"},{default:u(()=>[t(C,{align:"center",class:"ma-0"},{default:u(()=>[t(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:u(()=>[s("span",se,c(e.$t("basic.difficulty")),1)]),_:1}),t(v,{cols:"8",sm:"9",class:"pa-0"},{default:u(()=>[t(Z,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=l=>r.value=l),items:I,"item-title":"text","item-value":"value","hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{align:"center",class:"ma-0"},{default:u(()=>[t(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:u(()=>[s("span",ue,c(e.$t("basic.totalDamageDealt")),1)]),_:1}),t(v,{cols:"8",sm:"9",class:"pa-0"},{default:u(()=>[t(y,{type:"number",modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=l=>g.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{align:"center",class:"ma-0"},{default:u(()=>[t(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:u(()=>[s("span",oe,c(e.$t("basic.duo")),1)]),_:1}),t(v,{cols:"8",sm:"9",class:"pa-0"},{default:u(()=>[t(y,{type:"number",modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=l=>N.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{class:"ma-0"},{default:u(()=>[t(v,{class:"pa-0"},{default:u(()=>[s("div",de,[t(ee,null,{default:u(()=>[s("thead",null,[s("tr",null,[a[6]||(a[6]=s("th",null,null,-1)),s("th",ne,c(e.$t("basic.advantage")),1),s("th",ie,c(e.$t("basic.neutral")),1),s("th",re,c(e.$t("basic.disadvantage")),1)])]),s("tbody",null,[s("tr",null,[s("th",ce,[U(c(e.$t("basic.attack"))+" ",1),s("span",ve,[t(j,{style:{"white-space":"nowrap"},activator:"parent","open-on-click":""},{default:u(()=>[U(c(e.$t("basic.attackDetail")),1)]),_:1})])]),s("td",me,[t(y,{type:"number",modelValue:o.value.advantage,"onUpdate:modelValue":a[3]||(a[3]=l=>o.value.advantage=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",pe,[t(y,{type:"number",modelValue:o.value.equal,"onUpdate:modelValue":a[4]||(a[4]=l=>o.value.equal=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",be,[t(y,{type:"number",modelValue:o.value.disadvantage,"onUpdate:modelValue":a[5]||(a[5]=l=>o.value.disadvantage=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])])])])]),_:1})])]),_:1})]),_:1}),t(J,{data:E.value,scores:S.value,score:T.value},null,8,["data","scores","score"])]),_:1})]),_:1})]),_:1}))}}),Ce=te(fe,[["__scopeId","data-v-dbb029c2"]]);export{Ce as default};
