import{d as _e,r as p,e as re,I as ue,al as e,b2 as ce,c as de,w as c,a,g as r,b as v,t as m,l as f,j as u,k as L,F as R,o as _,ai as T,ap as Y,V as j,b3 as M,_ as me}from"./index-Bw3eHG9p.js";import{b as ve,_ as q,l as pe}from"./common-Bh2NzJ0i.js";import{c as H,V as Q}from"./characters_info-DFOdgsNn.js";import{V as ge,a as fe}from"./VRow-CSeV6AtI.js";import{V as W,a as X}from"./VCard-2_NkG6dx.js";import{V as Z,a as Ee}from"./VCardText-BJFVRdO_.js";import{V as F}from"./VSpacer-VGzzvP8A.js";import{V as Ae}from"./VContainer-BY2-5icZ.js";const Ve={class:"reset-area"},Ce={class:"reset-container"},Ie={class:"reset-btn-wrapper"},Te={class:"elapsed-time"},Le={class:"character-selection-area"},Re={class:"character-column"},De=["onClick"],Oe=["src","alt"],Pe={key:1,class:"empty-slot"},he=["onClick"],ke={class:"input-fields"},be={class:"input-row"},Se={class:"custom-select"},ye=["onClick"],we=["src","alt"],$e={key:1,class:"dropdown-icon"},Ue={key:0,class:"select-options"},Ne=["onClick"],je=["src","alt"],Me={class:"input-with-counter"},ze={class:"input-row"},Be={class:"custom-select"},Je=["onClick"],He=["src","alt"],Ke={key:1,class:"dropdown-icon"},Ge={key:0,class:"select-options"},Ye=["onClick"],qe=["src","alt"],Qe={class:"input-with-counter"},We={key:0,class:"input-row"},Xe={class:"custom-select"},Ze=["onClick"],Fe=["src","alt"],xe={key:1,class:"dropdown-icon"},et={key:0,class:"select-options"},tt=["onClick"],it=["src","alt"],ot={class:"input-with-counter"},lt={key:1,class:"input-row"},st={class:"custom-select"},at=["onClick"],nt=["src","alt"],_t={key:1,class:"dropdown-icon"},rt={key:0,class:"select-options"},ut=["onClick"],ct=["src","alt"],dt={class:"input-with-counter"},mt={class:"character-grid"},vt=["onClick"],pt=["src","alt"],gt={class:"clear-storage-area"},ft=_e({__name:"retire",setup(Et){const x=ve(),K=p(!0),D=p(!1),z=p(-1),A=p([null,null,null,null,null]),B=p({}),d={INPUT_VALUES:"retire_input_values",SELECTED_CHARACTERS:"retire_selected_characters",VISIBLE_FIELDS:"retire_visible_fields",RESET_COUNT:"retire_reset_count",LAST_RESET_TIME:"retire_last_reset_time"},V=p([{name:"火",value:"fire",icon:""},{name:"水",value:"water",icon:""},{name:"木",value:"flora",icon:""},{name:"無",value:"cosmic",icon:""}]),s=p([{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0}]),C=p(""),E=p([2,2,2,2,2]),O=p(0),h=p(0);let J=null;const P=p(!1),G=()=>{const o=localStorage.getItem(d.LAST_RESET_TIME);if(o){const l=Math.floor((Date.now()-parseInt(o))/1e3);h.value=l}},ee=()=>{try{const o=localStorage.getItem(d.INPUT_VALUES),l=localStorage.getItem(d.SELECTED_CHARACTERS),n=localStorage.getItem(d.VISIBLE_FIELDS),t=localStorage.getItem(d.RESET_COUNT),U=localStorage.getItem(d.LAST_RESET_TIME);if(o&&(s.value=JSON.parse(o)),l){const N=JSON.parse(l);A.value=N.map(i=>{if(!i)return null;let I="";return i.imgUrl?I=i.imgUrl:i.name_en&&B.value[i.name_en]&&(I=B.value[i.name_en]),{name_ja:i.name_ja,name_en:i.name_en,dorm:i.dorm,theme_1:i.theme_1,theme_2:i.theme_2,imgUrl:I}})}n&&(E.value=JSON.parse(n)),t&&(O.value=parseInt(t)),U&&G()}catch(o){console.error("ローカルストレージからの読み込みに失敗しました:",o)}},g=()=>{try{localStorage.setItem(d.INPUT_VALUES,JSON.stringify(s.value)),localStorage.setItem(d.SELECTED_CHARACTERS,JSON.stringify(A.value)),localStorage.setItem(d.VISIBLE_FIELDS,JSON.stringify(E.value)),localStorage.setItem(d.RESET_COUNT,O.value.toString())}catch(o){console.error("ローカルストレージへの保存に失敗しました:",o)}},te=re(()=>K.value?[]:H.filter(o=>o.imgUrl)),ie=o=>{z.value=o,D.value=!0},oe=o=>{z.value>=0&&(A.value[z.value]=o,g()),D.value=!1},k=(o,l)=>{const n=`${o}-${l}`;C.value=C.value===n?"":n},b=(o,l,n)=>{const t=`${l}Attribute`;s.value[o][t]=n,C.value="",g()},S=o=>{const l=V.value.find(n=>n.value===o);return(l==null?void 0:l.icon)||""},y=o=>{const l=V.value.find(n=>n.value===o);return(l==null?void 0:l.name)||""},w=(o,l)=>{const n=`${l}Count`,t=s.value[o][n];s.value[o][n]=t+1,g()},$=(o,l)=>{const n=`${l}Count`;s.value[o][n]=0,g()},le=o=>{E.value[o]<4&&(E.value[o]++,g())},se=()=>{s.value.forEach((o,l)=>{s.value[l].field1Count=0,s.value[l].field2Count=0,s.value[l].field3Count=0,s.value[l].field4Count=0}),O.value++,h.value=0,localStorage.setItem(d.LAST_RESET_TIME,Date.now().toString()),g()},ae=()=>{try{localStorage.removeItem(d.INPUT_VALUES),localStorage.removeItem(d.SELECTED_CHARACTERS),localStorage.removeItem(d.VISIBLE_FIELDS),localStorage.removeItem(d.RESET_COUNT),localStorage.removeItem(d.LAST_RESET_TIME),s.value=s.value.map(()=>({field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0})),A.value=[null,null,null,null,null],E.value=[2,2,2,2,2],O.value=0,h.value=0}catch(o){console.error("ローカルストレージのクリアに失敗しました:",o)}},ne=()=>{ae(),P.value=!1};return ue(async()=>{try{await Promise.all(V.value.map(async o=>{const l=await q(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-DvQu9m9W.js"),[]),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-BZiLWfYy.js"),[]),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-CpWNXwpG.js"),[]),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-DKaHgH9c.js"),[]),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-n_8T-jmA.js"),[]),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-D5khL09Y.js"),[]),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-BBaNaQhw.js"),[]),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-BGYkvP8v.js"),[]),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-B1g1udM1.js"),[]),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-DfZlWO8v.js"),[]),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-Dtbzp4jN.js"),[]),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-C3yuMUp0.js"),[]),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-tESm7ZP4.js"),[]),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-2uGF9yfF.js"),[]),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-CEU4IQaw.js"),[]),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-VErcANh7.js"),[]),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-RiwENnoc.js"),[]),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-BeFZ7J02.js"),[]),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-0NPCthpR.js"),[]),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-3bX6EOCv.js"),[]),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-miMNYYO4.js"),[]),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-CTJq5aM9.js"),[]),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-DRbniuB3.js"),[]),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-DoZujolI.js"),[]),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-BPNAdJt2.js"),[]),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-BZkpACfU.js"),[]),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-QjaGOZNo.js"),[]),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-D8Qdb6T-.js"),[]),"../assets/img/icon/train.png":()=>e(()=>import("./train-DsisYyZD.js"),[]),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-CIMGdku1.js"),[]),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-Db8msllK.js"),[]),"../assets/img/icon/water.png":()=>e(()=>import("./water-Bm78Orf8.js"),[])}),`../assets/img/icon/${o.value}.png`,5);o.icon=l.default})),B.value=await pe(H,o=>o.name_en),await Promise.all(H.map(o=>q(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-DvQu9m9W.js"),[]),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-BZiLWfYy.js"),[]),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-CpWNXwpG.js"),[]),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-DKaHgH9c.js"),[]),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-n_8T-jmA.js"),[]),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-D5khL09Y.js"),[]),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-BBaNaQhw.js"),[]),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-BGYkvP8v.js"),[]),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-B1g1udM1.js"),[]),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-DfZlWO8v.js"),[]),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-Dtbzp4jN.js"),[]),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-C3yuMUp0.js"),[]),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-tESm7ZP4.js"),[]),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-2uGF9yfF.js"),[]),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-CEU4IQaw.js"),[]),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-VErcANh7.js"),[]),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-RiwENnoc.js"),[]),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-BeFZ7J02.js"),[]),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-0NPCthpR.js"),[]),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-3bX6EOCv.js"),[]),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-miMNYYO4.js"),[]),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-CTJq5aM9.js"),[]),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-DRbniuB3.js"),[]),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-DoZujolI.js"),[]),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-BPNAdJt2.js"),[]),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-BZkpACfU.js"),[]),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-QjaGOZNo.js"),[]),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-D8Qdb6T-.js"),[]),"../assets/img/icon/train.png":()=>e(()=>import("./train-DsisYyZD.js"),[]),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-CIMGdku1.js"),[]),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-Db8msllK.js"),[]),"../assets/img/icon/water.png":()=>e(()=>import("./water-Bm78Orf8.js"),[])}),`../assets/img/icon/${o.name_en}.png`,5).then(l=>{o.imgUrl=l.default}).catch(()=>{o.imgUrl=""}))),ee(),J=window.setInterval(G,1e3)}finally{K.value=!1}x.handlePageChange("retirePage")}),ce(()=>{J!==null&&clearInterval(J)}),(o,l)=>(_(),de(Ae,null,{default:c(()=>[a("div",Ve,[a("div",Ce,[a("div",Ie,[r(f,{class:"reset-btn",size:"small",onClick:se},{default:c(()=>[v(m(o.$t("retire.reset"))+" ("+m(O.value)+m(o.$t("retire.num"))+") ",1)]),_:1})]),a("span",Te,m(h.value)+" "+m(o.$t("retire.seconds")),1)])]),r(fe,null,{default:c(()=>[r(ge,{cols:"12",class:"d-flex justify-center"},{default:c(()=>[a("div",Le,[(_(),u(R,null,L(5,(n,t)=>{var U,N;return a("div",{key:t,class:"character-row"},[a("div",Re,[a("div",{class:"character-slot",onClick:i=>ie(t)},[A.value[t]?(_(),u("img",{key:0,src:(U=A.value[t])==null?void 0:U.imgUrl,alt:(N=A.value[t])==null?void 0:N.name_en,class:"character-image"},null,8,Oe)):(_(),u("div",Pe,[r(Y,null,{default:c(()=>l[5]||(l[5]=[v("mdi-plus")])),_:1,__:[5]})]))],8,De),E.value[t]<4?(_(),u("div",{key:0,class:"add-field-btn",onClick:i=>le(t)},[r(Y,{size:"small"},{default:c(()=>l[6]||(l[6]=[v("mdi-plus")])),_:1,__:[6]})],8,he)):T("",!0)]),a("div",ke,[a("div",be,[a("div",Se,[a("div",{class:"select-header",onClick:i=>k(t,"field1")},[s.value[t].field1Attribute?(_(),u("img",{key:0,src:S(s.value[t].field1Attribute),alt:y(s.value[t].field1Attribute),class:"attribute-icon"},null,8,we)):(_(),u("span",$e,"▽"))],8,ye),C.value===`${t}-field1`?(_(),u("div",Ue,[(_(!0),u(R,null,L(V.value,i=>(_(),u("div",{key:i.value,class:"select-option",onClick:I=>b(t,"field1",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,je)],8,Ne))),128))])):T("",!0)]),a("div",Me,[r(j,{modelValue:s.value[t].field1,"onUpdate:modelValue":[i=>s.value[t].field1=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),r(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field1"),onContextmenu:M(i=>$(t,"field1"),["prevent"])},{default:c(()=>[v(m(s.value[t].field1Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),a("div",ze,[a("div",Be,[a("div",{class:"select-header",onClick:i=>k(t,"field2")},[s.value[t].field2Attribute?(_(),u("img",{key:0,src:S(s.value[t].field2Attribute),alt:y(s.value[t].field2Attribute),class:"attribute-icon"},null,8,He)):(_(),u("span",Ke,"▽"))],8,Je),C.value===`${t}-field2`?(_(),u("div",Ge,[(_(!0),u(R,null,L(V.value,i=>(_(),u("div",{key:i.value,class:"select-option",onClick:I=>b(t,"field2",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,qe)],8,Ye))),128))])):T("",!0)]),a("div",Qe,[r(j,{modelValue:s.value[t].field2,"onUpdate:modelValue":[i=>s.value[t].field2=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),r(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field2"),onContextmenu:M(i=>$(t,"field2"),["prevent"])},{default:c(()=>[v(m(s.value[t].field2Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),E.value[t]>=3?(_(),u("div",We,[a("div",Xe,[a("div",{class:"select-header",onClick:i=>k(t,"field3")},[s.value[t].field3Attribute?(_(),u("img",{key:0,src:S(s.value[t].field3Attribute),alt:y(s.value[t].field3Attribute),class:"attribute-icon"},null,8,Fe)):(_(),u("span",xe,"▽"))],8,Ze),C.value===`${t}-field3`?(_(),u("div",et,[(_(!0),u(R,null,L(V.value,i=>(_(),u("div",{key:i.value,class:"select-option",onClick:I=>b(t,"field3",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,it)],8,tt))),128))])):T("",!0)]),a("div",ot,[r(j,{modelValue:s.value[t].field3,"onUpdate:modelValue":[i=>s.value[t].field3=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),r(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field3"),onContextmenu:M(i=>$(t,"field3"),["prevent"])},{default:c(()=>[v(m(s.value[t].field3Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):T("",!0),E.value[t]>=4?(_(),u("div",lt,[a("div",st,[a("div",{class:"select-header",onClick:i=>k(t,"field4")},[s.value[t].field4Attribute?(_(),u("img",{key:0,src:S(s.value[t].field4Attribute),alt:y(s.value[t].field4Attribute),class:"attribute-icon"},null,8,nt)):(_(),u("span",_t,"▽"))],8,at),C.value===`${t}-field4`?(_(),u("div",rt,[(_(!0),u(R,null,L(V.value,i=>(_(),u("div",{key:i.value,class:"select-option",onClick:I=>b(t,"field4",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,ct)],8,ut))),128))])):T("",!0)]),a("div",dt,[r(j,{modelValue:s.value[t].field4,"onUpdate:modelValue":[i=>s.value[t].field4=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),r(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field4"),onContextmenu:M(i=>$(t,"field4"),["prevent"])},{default:c(()=>[v(m(s.value[t].field4Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):T("",!0)])])}),64))])]),_:1})]),_:1}),r(Q,{modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=n=>D.value=n),"max-width":"800px"},{default:c(()=>[r(W,null,{default:c(()=>[r(Z,null,{default:c(()=>[a("div",mt,[(_(!0),u(R,null,L(te.value,n=>(_(),u("div",{key:n.name_en,class:"character-item",onClick:t=>oe(n)},[a("img",{src:n.imgUrl,alt:n.name_en,class:"character-image"},null,8,pt)],8,vt))),128))])]),_:1}),r(X,null,{default:c(()=>[r(F),r(f,{color:"primary",onClick:l[0]||(l[0]=n=>D.value=!1)},{default:c(()=>l[7]||(l[7]=[v("Close")])),_:1,__:[7]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",gt,[r(f,{class:"clear-storage-btn",size:"small",onClick:l[2]||(l[2]=n=>P.value=!0)},{default:c(()=>[v(m(o.$t("retire.clear_content")),1)]),_:1})]),r(Q,{modelValue:P.value,"onUpdate:modelValue":l[4]||(l[4]=n=>P.value=n),"max-width":"400"},{default:c(()=>[r(W,null,{default:c(()=>[r(Ee,{class:"text-h5"},{default:c(()=>[v(m(o.$t("retire.confirm_clear")),1)]),_:1}),r(Z,null,{default:c(()=>[v(m(o.$t("retire.confirm_clear_message")),1)]),_:1}),r(X,null,{default:c(()=>[r(F),r(f,{color:"grey-darken-1",variant:"text",onClick:l[3]||(l[3]=n=>P.value=!1)},{default:c(()=>[v(m(o.$t("retire.cancel")),1)]),_:1}),r(f,{color:"error",variant:"text",onClick:ne},{default:c(()=>[v(m(o.$t("retire.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Ot=me(ft,[["__scopeId","data-v-63565d30"]]);export{Ot as default};
