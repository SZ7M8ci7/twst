import{d as te,r as d,e as ie,R as oe,ah as e,aY as le,o as r,c as se,w as m,a,h as u,b as g,t as v,l as I,j as n,k as T,F as L,aj as K,y as C,V as U,b9 as N,_ as ae}from"./index-2c9e4a26.js";import{u as re,_ as Y}from"./characters-f01707c2.js";import{c as z,V as ne}from"./VDialog-990b57f0.js";import{f as _e}from"./common-cb2fe1d1.js";import{V as ue,a as ce}from"./VRow-e94983e3.js";import{V as me,a as de}from"./VCard-153e9604.js";import{V as pe}from"./VCardText-6099ef2b.js";import{V as ve}from"./VSpacer-07d58bfa.js";import{V as ge}from"./VContainer-5bd2aedb.js";const fe={class:"reset-area"},Ee={class:"reset-container"},Ae={class:"reset-btn-wrapper"},Ve={class:"elapsed-time"},Ie={class:"character-selection-area"},Ce={class:"character-column"},Te=["onClick"],Le=["src","alt"],Re={key:1,class:"empty-slot"},he=["onClick"],De={class:"input-fields"},Oe={class:"input-row"},Pe={class:"custom-select"},Se=["onClick"],be=["src","alt"],ke={key:1,class:"dropdown-icon"},ye={key:0,class:"select-options"},we=["onClick"],$e=["src","alt"],Ue={class:"input-with-counter"},Ne={class:"input-row"},Fe={class:"custom-select"},je=["onClick"],Me=["src","alt"],ze={key:1,class:"dropdown-icon"},Be={key:0,class:"select-options"},Je=["onClick"],He=["src","alt"],Ke={class:"input-with-counter"},Ye={key:0,class:"input-row"},Ge={class:"custom-select"},qe=["onClick"],Qe=["src","alt"],We={key:1,class:"dropdown-icon"},Xe={key:0,class:"select-options"},Ze=["onClick"],xe=["src","alt"],et={class:"input-with-counter"},tt={key:1,class:"input-row"},it={class:"custom-select"},ot=["onClick"],lt=["src","alt"],st={key:1,class:"dropdown-icon"},at={key:0,class:"select-options"},rt=["onClick"],nt=["src","alt"],_t={class:"input-with-counter"},ut={class:"character-grid"},ct=["onClick"],mt=["src","alt"],dt={class:"clear-storage-area"},pt=te({__name:"retire",setup(vt){const G=re(),B=d(!0),R=d(!1),F=d(-1),E=d([null,null,null,null,null]),J=d({}),c={INPUT_VALUES:"retire_input_values",SELECTED_CHARACTERS:"retire_selected_characters",VISIBLE_FIELDS:"retire_visible_fields",RESET_COUNT:"retire_reset_count",LAST_RESET_TIME:"retire_last_reset_time"},A=d([{name:"火",value:"fire",icon:""},{name:"水",value:"water",icon:""},{name:"木",value:"flora",icon:""},{name:"無",value:"cosmic",icon:""}]),l=d([{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0}]),V=d(""),f=d([2,2,2,2,2]),h=d(0),D=d(0);let j=null;const H=()=>{const i=localStorage.getItem(c.LAST_RESET_TIME);if(i){const s=Math.floor((Date.now()-parseInt(i))/1e3);D.value=s}},q=()=>{try{const i=localStorage.getItem(c.INPUT_VALUES),s=localStorage.getItem(c.SELECTED_CHARACTERS),_=localStorage.getItem(c.VISIBLE_FIELDS),t=localStorage.getItem(c.RESET_COUNT),w=localStorage.getItem(c.LAST_RESET_TIME);if(i&&(l.value=JSON.parse(i)),s){const $=JSON.parse(s);E.value=$.map(o=>o?{...o,imgUrl:J.value[o.name_en]||""}:null)}_&&(f.value=JSON.parse(_)),t&&(h.value=parseInt(t)),w&&H()}catch(i){console.error("ローカルストレージからの読み込みに失敗しました:",i)}},p=()=>{try{localStorage.setItem(c.INPUT_VALUES,JSON.stringify(l.value)),localStorage.setItem(c.SELECTED_CHARACTERS,JSON.stringify(E.value)),localStorage.setItem(c.VISIBLE_FIELDS,JSON.stringify(f.value)),localStorage.setItem(c.RESET_COUNT,h.value.toString())}catch(i){console.error("ローカルストレージへの保存に失敗しました:",i)}},Q=ie(()=>B.value?[]:z.filter(i=>i.imgUrl)),W=i=>{F.value=i,R.value=!0},X=i=>{F.value>=0&&(E.value[F.value]=i,p()),R.value=!1},O=(i,s)=>{const _=`${i}-${s}`;V.value=V.value===_?"":_},P=(i,s,_)=>{const t=`${s}Attribute`;l.value[i][t]=_,V.value="",p()},S=i=>{const s=A.value.find(_=>_.value===i);return(s==null?void 0:s.icon)||""},b=i=>{const s=A.value.find(_=>_.value===i);return(s==null?void 0:s.name)||""},k=(i,s)=>{const _=`${s}Count`,t=l.value[i][_];l.value[i][_]=t+1,p()},y=(i,s)=>{const _=`${s}Count`;l.value[i][_]=0,p()},Z=i=>{f.value[i]<4&&(f.value[i]++,p())},x=()=>{l.value.forEach((i,s)=>{l.value[s].field1Count=0,l.value[s].field2Count=0,l.value[s].field3Count=0,l.value[s].field4Count=0}),h.value++,D.value=0,localStorage.setItem(c.LAST_RESET_TIME,Date.now().toString()),p()},ee=()=>{try{localStorage.removeItem(c.INPUT_VALUES),localStorage.removeItem(c.SELECTED_CHARACTERS),localStorage.removeItem(c.VISIBLE_FIELDS),localStorage.removeItem(c.RESET_COUNT),localStorage.removeItem(c.LAST_RESET_TIME),l.value=l.value.map(()=>({field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0})),E.value=[null,null,null,null,null],f.value=[2,2,2,2,2],h.value=0,D.value=0}catch(i){console.error("ローカルストレージのクリアに失敗しました:",i)}};return oe(async()=>{try{await Promise.all(A.value.map(async i=>{const s=await Y(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${i.value}.png`);i.icon=s.default})),J.value=await _e(z),await Promise.all(z.map(i=>Y(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${i.name_en}.png`).then(s=>{i.imgUrl=s.default}).catch(()=>{i.imgUrl=""}))),q(),j=window.setInterval(H,1e3)}finally{B.value=!1}G.handlePageChange("retirePage")}),le(()=>{j!==null&&clearInterval(j)}),(i,s)=>(r(),se(ge,null,{default:m(()=>[a("div",fe,[a("div",Ee,[a("div",Ae,[u(I,{class:"reset-btn",size:"small",onClick:x},{default:m(()=>[g(v(i.$t("retire.reset"))+" ("+v(h.value)+v(i.$t("retire.num"))+") ",1)]),_:1})]),a("span",Ve,v(D.value)+" "+v(i.$t("retire.seconds")),1)])]),u(ce,null,{default:m(()=>[u(ue,{cols:"12",class:"d-flex justify-center"},{default:m(()=>[a("div",Ie,[(r(),n(L,null,T(5,(_,t)=>{var w,$;return a("div",{key:t,class:"character-row"},[a("div",Ce,[a("div",{class:"character-slot",onClick:o=>W(t)},[E.value[t]?(r(),n("img",{key:0,src:(w=E.value[t])==null?void 0:w.imgUrl,alt:($=E.value[t])==null?void 0:$.name_en,class:"character-image"},null,8,Le)):(r(),n("div",Re,[u(K,null,{default:m(()=>[g("mdi-plus")]),_:1})]))],8,Te),f.value[t]<4?(r(),n("div",{key:0,class:"add-field-btn",onClick:o=>Z(t)},[u(K,{size:"small"},{default:m(()=>[g("mdi-plus")]),_:1})],8,he)):C("",!0)]),a("div",De,[a("div",Oe,[a("div",Pe,[a("div",{class:"select-header",onClick:o=>O(t,"field1")},[l.value[t].field1Attribute?(r(),n("img",{key:0,src:S(l.value[t].field1Attribute),alt:b(l.value[t].field1Attribute),class:"attribute-icon"},null,8,be)):(r(),n("span",ke,"▽"))],8,Se),V.value===`${t}-field1`?(r(),n("div",ye,[(r(!0),n(L,null,T(A.value,o=>(r(),n("div",{key:o.value,class:"select-option",onClick:M=>P(t,"field1",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,$e)],8,we))),128))])):C("",!0)]),a("div",Ue,[u(U,{modelValue:l.value[t].field1,"onUpdate:modelValue":[o=>l.value[t].field1=o,p],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(I,{size:"small",class:"counter-btn",onClick:o=>k(t,"field1"),onContextmenu:N(o=>y(t,"field1"),["prevent"])},{default:m(()=>[g(v(l.value[t].field1Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),a("div",Ne,[a("div",Fe,[a("div",{class:"select-header",onClick:o=>O(t,"field2")},[l.value[t].field2Attribute?(r(),n("img",{key:0,src:S(l.value[t].field2Attribute),alt:b(l.value[t].field2Attribute),class:"attribute-icon"},null,8,Me)):(r(),n("span",ze,"▽"))],8,je),V.value===`${t}-field2`?(r(),n("div",Be,[(r(!0),n(L,null,T(A.value,o=>(r(),n("div",{key:o.value,class:"select-option",onClick:M=>P(t,"field2",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,He)],8,Je))),128))])):C("",!0)]),a("div",Ke,[u(U,{modelValue:l.value[t].field2,"onUpdate:modelValue":[o=>l.value[t].field2=o,p],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(I,{size:"small",class:"counter-btn",onClick:o=>k(t,"field2"),onContextmenu:N(o=>y(t,"field2"),["prevent"])},{default:m(()=>[g(v(l.value[t].field2Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),f.value[t]>=3?(r(),n("div",Ye,[a("div",Ge,[a("div",{class:"select-header",onClick:o=>O(t,"field3")},[l.value[t].field3Attribute?(r(),n("img",{key:0,src:S(l.value[t].field3Attribute),alt:b(l.value[t].field3Attribute),class:"attribute-icon"},null,8,Qe)):(r(),n("span",We,"▽"))],8,qe),V.value===`${t}-field3`?(r(),n("div",Xe,[(r(!0),n(L,null,T(A.value,o=>(r(),n("div",{key:o.value,class:"select-option",onClick:M=>P(t,"field3",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,xe)],8,Ze))),128))])):C("",!0)]),a("div",et,[u(U,{modelValue:l.value[t].field3,"onUpdate:modelValue":[o=>l.value[t].field3=o,p],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(I,{size:"small",class:"counter-btn",onClick:o=>k(t,"field3"),onContextmenu:N(o=>y(t,"field3"),["prevent"])},{default:m(()=>[g(v(l.value[t].field3Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):C("",!0),f.value[t]>=4?(r(),n("div",tt,[a("div",it,[a("div",{class:"select-header",onClick:o=>O(t,"field4")},[l.value[t].field4Attribute?(r(),n("img",{key:0,src:S(l.value[t].field4Attribute),alt:b(l.value[t].field4Attribute),class:"attribute-icon"},null,8,lt)):(r(),n("span",st,"▽"))],8,ot),V.value===`${t}-field4`?(r(),n("div",at,[(r(!0),n(L,null,T(A.value,o=>(r(),n("div",{key:o.value,class:"select-option",onClick:M=>P(t,"field4",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,nt)],8,rt))),128))])):C("",!0)]),a("div",_t,[u(U,{modelValue:l.value[t].field4,"onUpdate:modelValue":[o=>l.value[t].field4=o,p],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(I,{size:"small",class:"counter-btn",onClick:o=>k(t,"field4"),onContextmenu:N(o=>y(t,"field4"),["prevent"])},{default:m(()=>[g(v(l.value[t].field4Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):C("",!0)])])}),64))])]),_:1})]),_:1}),u(ne,{modelValue:R.value,"onUpdate:modelValue":s[1]||(s[1]=_=>R.value=_),"max-width":"800px"},{default:m(()=>[u(me,null,{default:m(()=>[u(pe,null,{default:m(()=>[a("div",ut,[(r(!0),n(L,null,T(Q.value,_=>(r(),n("div",{key:_.name_en,class:"character-item",onClick:t=>X(_)},[a("img",{src:_.imgUrl,alt:_.name_en,class:"character-image"},null,8,mt)],8,ct))),128))])]),_:1}),u(de,null,{default:m(()=>[u(ve),u(I,{color:"primary",onClick:s[0]||(s[0]=_=>R.value=!1)},{default:m(()=>[g("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",dt,[u(I,{class:"clear-storage-btn",size:"small",onClick:ee},{default:m(()=>[g(v(i.$t("retire.clear_content")),1)]),_:1})])]),_:1}))}});const Rt=ae(pt,[["__scopeId","data-v-1852a2df"]]);export{Rt as default};
