import{G as Re,v as re,B as c}from"./index-875b9d0a.js";import{u as Ie,_ as Me}from"./characters-48892296.js";const Oe=Re("searchSettings",{state:()=>({minEHP:3e4,minHP:3e4,minHPBuddy:0,minIncreasedHPBuddy:0,minEvasion:0,minDuo:0,minBuff:0,minDebuff:0,minCosmic:0,minFire:0,minWater:0,minFlora:0,minReferenceDamage:0,minReferenceAdvantageDamage:0,minReferenceVsHiDamage:0,minReferenceVsMizuDamage:0,minReferenceVsKiDamage:0,maxResult:10,attackNum:10,sortOptions:[{prop:"HP",order:"降順"}],mustCharacters:[],convertedMustCharacters:[],allowSameCharacter:!0}),actions:{updateSearchSettings(t){Object.assign(this,t)}}}),Se=Re("searchResult",{state:()=>({totalResults:0,nowResults:0,results:[],isSearching:!1,errorMessage:""})}),Ce=Oe(),{minEHP:Ke,minHP:Ue,minDebuff:Fe,minBuff:qe,minHPBuddy:ze,minIncreasedHPBuddy:je,minEvasion:Ne,minDuo:We,minCosmic:$e,minFire:Je,minWater:Ge,minFlora:xe,minReferenceDamage:Ze,minReferenceAdvantageDamage:Qe,minReferenceVsHiDamage:Xe,minReferenceVsKiDamage:Ye,minReferenceVsMizuDamage:et,maxResult:pe,sortOptions:tt,convertedMustCharacters:at,allowSameCharacter:it,attackNum:z}=re(Ce),rt=Ie(),{characters:_e}=re(rt),ot=Se(),{totalResults:$,nowResults:ve,results:P,isSearching:De,errorMessage:Q}=re(ot);function pt(t){(t.key==="e"||t.key==="+")&&t.preventDefault()}function st(t){return[t("comments.HP"),t("comments.effectiveHP"),t("comments.HPBuddy"),t("comments.increasedHPBuddy"),t("comments.noHPBuddy"),t("comments.buddy"),t("comments.evasion"),t("comments.duo"),t("comments.buff"),t("comments.debuff"),t("comments.maxCosmic"),t("comments.maxFire"),t("comments.maxWater"),t("comments.maxFlora"),t("comments.neutralDamage"),t("comments.advantageDamage"),t("comments.damageAgainstFire"),t("comments.damageAgainstWater"),t("comments.damageAgainstFlora")]}function _t(t){return[t("comments.riddle"),t("comments.ace"),t("comments.deuce"),t("comments.cater"),t("comments.trey"),t("comments.leona"),t("comments.jack"),t("comments.ruggie"),t("comments.azul"),t("comments.jade"),t("comments.floyd"),t("comments.kalim"),t("comments.jamil"),t("comments.vil"),t("comments.epel"),t("comments.rook"),t("comments.idia"),t("comments.ortho"),t("comments.malleus"),t("comments.silver"),t("comments.sebek"),t("comments.lilia"),t("comments.grim"),t("comments.lolo"),t("comments.crowley"),t("comments.crewel"),t("comments.fellow"),t("comments.train")]}const nt=["hp","ehp","hpBuddy","increasedHpBuddy","noHpBuddy","buddy","evasion","duo","buff","debuff","maxCosmic","maxFire","maxWater","maxFlora","referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"],vt={Riddle:"リドル",Ace:"エース",Deuce:"デュース",Cater:"ケイト",Trey:"トレイ",Leona:"レオナ",Jack:"ジャック",Ruggie:"ラギー",Azul:"アズール",Jade:"ジェイド",Floyd:"フロイド",Kalim:"カリム",Jamil:"ジャミル",Vil:"ヴィル",Epel:"エペル",Rook:"ルーク",Idia:"イデア",Ortho:"オルト",Malleus:"マレウス",Silver:"シルバー",Sebek:"セベク",Lilia:"リリア",Grim:"グリム",Lolo:"ロロ",Crowley:"クロウリー",Crewel:"クルーウェル",Fellow:"フェロー",Train:"トレイン"},G={"HPUP(小)":{hp:.2,atk:0,heal:0,conHeal:0},"HP&ATKUP(小)":{hp:.2,atk:.2,heal:0,conHeal:0},"HPUP(中)":{hp:.3,atk:0,heal:0,conHeal:0},"HP&ATKUP(中)":{hp:.3,atk:.35,heal:0,conHeal:0},"ATKUP(小)":{hp:0,atk:.2,heal:0,conHeal:0},"ATKUP(中)":{hp:0,atk:.35,heal:0,conHeal:0},"回復(小)":{hp:0,atk:0,heal:1.1,conHeal:0},"回復&継続回復(小)":{hp:0,atk:0,heal:1.1,conHeal:.15*3},"回復(中)":{hp:0,atk:0,heal:1.7,conHeal:0},"回復&継続回復(中)":{hp:0,atk:0,heal:1.7,conHeal:.25*3},"継続回復(小)":{hp:0,atk:0,heal:0,conHeal:.15*3},"継続回復(中)":{hp:0,atk:0,heal:0,conHeal:.25*3}};function X(t){var i;return((i=G[t])==null?void 0:i.hp)||0}function Y(t){var i;return((i=G[t])==null?void 0:i.atk)||0}function ee(t){var i;return((i=G[t])==null?void 0:i.heal)||0}function te(t){var i;return((i=G[t])==null?void 0:i.conHeal)||0}const mt={"ATKUP(極小)":1.1,"ATKUP(小)":1.2,"ATKUP(中)":1.35,"ATKUP(大)":1.5,"ATKUP(極大)":1.8},ct={"ダメUP(極小)":.025,"ダメUP(小)":.05,"ダメUP(中)":.0875,"ダメUP(大)":.125,"ダメUP(極大)":.1875,"属性ダメUP(極小)":.03,"属性ダメUP(小)":.06,"属性ダメUP(中)":.1005,"属性ダメUP(大)":.15,"属性ダメUP(極大)":.27},ae={};function ut(t,i,f,o){const n=`${t},${i},${f},${o}`;if(n in ae)return ae[n];let R=i.includes("弱")?.75:1;R*=f==="無"?1.1:1,R+=ct[t]||0;let p=1;(i=="連撃(弱)"||i=="連撃(強)")&&(p=1.8),(i=="デュオ魔法"||i=="3連撃(弱)")&&(p=2.4);const h=o*R*p;return ae[n]=h,h}function ie(t,i,f,o,n){return o=(mt[t]||1)*o+o*n,ut(t,i,f=="無"?"無":"無以外",o)}function j(t,i,f){const o=[t,i,f];return o.sort((n,R)=>R-n),[o[0],o[1]]}function lt(t){const i=new Set;for(const e of t)i.add(e.chara);if(!Array.from(at.value).every(e=>i.has(e)))return;let o=0,n=0,R=0,p=0,h=0,A=0,L=0,E=0,u=0,C=0,a=0,m=0,l=0,d=99999;const _=[],v=[],D=[],s=[],b=[];let V=0,K=0,U=0,F=0,q=0;const y={},x={},k={},oe=[];let se="";const w=[],ne=[],me=[],ce=[],ue=[],le=[],fe=[];t.sort((e,r)=>r.calcBaseATK-e.calcBaseATK),t.forEach((e,r)=>{y[r]=!1,x[r]=!1,k[r]=!1});function N(e,r){let H=0;return e.magic1atr==r&&(H+=1),e.magic2atr==r&&(H+=1),e.magic3atr==r&&e.hasM3&&(H+=1),Math.min(H,2)}if(t.forEach((e,r)=>{oe.push(e.imgUrl),se+="&name"+(r+1)+"="+e.name,o+=e.calcBaseHP,L+=e.buff_count,E+=e.debuff_count,C+=N(e,"無"),a+=N(e,"火"),m+=N(e,"水"),l+=N(e,"木");let H=!1,B=0,W=0;if(i.has(e.buddy1c)){h+=1;const g=X(e.buddy1s);B+=Y(e.buddy1s),g!=0&&(p+=1,H=!0,o+=e.calcBaseHP*g,W+=e.calcBaseHP*g)}if(i.has(e.buddy2c)){h+=1;const g=X(e.buddy2s);B+=Y(e.buddy2s),g!=0&&(p+=1,H=!0,o+=e.calcBaseHP*g,W+=e.calcBaseHP*g)}if(i.has(e.buddy3c)){h+=1;const g=X(e.buddy3s);B+=Y(e.buddy3s),g!=0&&(p+=1,H=!0,o+=e.calcBaseHP*g,W+=e.calcBaseHP*g)}d=Math.min(d,W);const ge=(ee(e.magic1heal)+ee(e.magic2heal)+(e.hasM3?ee(e.magic3heal):0))*e.calcBaseATK,de=(te(e.magic1heal)+te(e.magic2heal)+(e.hasM3?te(e.magic3heal):0))*e.calcBaseHP;n+=ge+de,ne.push(ge+de),R+=e.evasion,H||(A+=1);let Z=e.magic2pow;if(k[r])Z="デュオ",u+=1;else{if(!k[r]){for(const[g,S]of t.entries())if(S.duo==e.chara&&e.duo==S.chara&&!k[r]&&!k[g]){k[r]=!0,k[g]=!0,y[r]=!0,y[g]=!0;break}if(!y[r]){for(const[g,S]of t.entries())if(e.duo==S.chara&&!k[r]&&!y[r]&&!x[g]){k[r]=!0,y[r]=!0,x[g]=!0;break}}if(!y[r]){for(const[g,S]of t.entries())if(e.duo==S.chara&&!k[r]&&!y[r]&&!y[g]){k[r]=!0,y[r]=!0,y[g]=!0;break}}}k[r]&&(Z="デュオ",u+=1)}const I=ie(e.magic1buf,e.magic1pow,e.magic1atr,e.calcBaseATK,B),M=ie(e.magic2buf,Z,e.magic2atr,e.calcBaseATK,B),O=e.hasM3?ie(e.magic3buf,e.magic3pow,e.magic3atr,e.calcBaseATK,B):0,ke=e.magic1atr=="無"?I:I*1.5,ye=e.magic2atr=="無"?M:M*1.5,Ae=e.magic3atr=="無"?O:O*1.5,he=T(e.magic1atr,"火",I),Ee=T(e.magic2atr,"火",M),He=T(e.magic3atr,"火",O),Te=T(e.magic1atr,"水",I),Le=T(e.magic2atr,"水",M),be=T(e.magic3atr,"水",O),Ve=T(e.magic1atr,"木",I),we=T(e.magic2atr,"木",M),Be=T(e.magic3atr,"木",O);_.push(...j(I,M,O)),v.push(...j(ke,ye,Ae)),D.push(...j(he,Ee,He)),s.push(...j(Te,Le,be)),b.push(...j(Ve,we,Be)),me.push(_.at(-1)+_.at(-2)),ce.push(v.at(-1)+v.at(-2)),ue.push(D.at(-1)+D.at(-2)),le.push(s.at(-1)+s.at(-2)),fe.push(b.at(-1)+b.at(-2))}),V=_.sort((e,r)=>r-e).slice(0,z.value).reduce((e,r)=>e+r,0),K=v.sort((e,r)=>r-e).slice(0,z.value).reduce((e,r)=>e+r,0),U=D.sort((e,r)=>r-e).slice(0,z.value).reduce((e,r)=>e+r,0),F=s.sort((e,r)=>r-e).slice(0,z.value).reduce((e,r)=>e+r,0),q=b.sort((e,r)=>r-e).slice(0,z.value).reduce((e,r)=>e+r,0),!(o<Ue.value)&&!(o+n<Ke.value)&&!(p<ze.value)&&!(d<je.value)&&!(R<Ne.value)&&!(u<We.value)&&!(L<qe.value)&&!(E<Fe.value)&&!(C<$e.value)&&!(a<Je.value)&&!(m<Ge.value)&&!(l<xe.value)&&!(V<Ze.value)&&!(K<Qe.value)&&!(U<Xe.value)&&!(F<et.value)&&!(q<Ye.value))return V=Math.floor(V),K=Math.floor(K),U=Math.floor(U),F=Math.floor(F),q=Math.floor(q),d=Math.floor(d),w.push(ne),w.push(me),w.push(ce),w.push(ue),w.push(le),w.push(fe),[o,o+n,R,p,d,h,A,u,L,E,C,a,m,l,V,K,U,F,q,...oe,se,w]}const ft={水:{火:1.5,木:.5},木:{水:1.5,火:.5},火:{木:1.5,水:.5}};function T(t,i,f){var n;const o=(n=ft[t])==null?void 0:n[i];return o?f*o:f}function Pe(t){return function(i,f){for(let o=0;o<t.length;o++){const{key:n,order:R}=t[o];if(!Object.prototype.hasOwnProperty.call(i,n)||!Object.prototype.hasOwnProperty.call(f,n))continue;let p=0;if(i[n]<f[n]?p=-1:i[n]>f[n]&&(p=1),p!==0)return R==="降順"?p*-1:p}return 0}}function J(t){return t<=0?1:t*J(t-1)}async function Dt(t){for(const a of _e.value)if(a.required&&a.level==0){Q.value=t("error.requiredCharacter");return}const i=_e.value.filter(a=>a.level>0),f=i.length;if(f<5){Q.value=t("error.fewCharacter");return}ve.value=0;const o=st(t),n=[];for(const a of tt.value)for(let m=0;m<o.length;m++)if(o[m]==a.prop){let l="降順";switch(a.order){case"ASC":l="昇順";break;case"DESC":l="降順";break;case"昇順":case"降順":l=a.order;break;default:continue}n.push({key:nt[m],order:l})}const R=n[0].order==="昇順";async function p(){P.value.sort(Pe(n));const a=P.value.slice(0,pe.value);P.value=[...a],P.value.length>0&&(L=P.value[P.value.length-1][n[0].key]),await new Promise(requestAnimationFrame)}const h=new Set(["referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"]);n[0].key in h?i.sort((a,m)=>a.required&&!m.required?-1:!a.required&&m.required?1:m.atk-a.atk):i.sort((a,m)=>a.required&&!m.required?-1:!a.required&&m.required?1:m.hp-a.hp);const A=i.filter(a=>a.required).length;if(A>5){Q.value="必須設定されたキャラが多すぎます";return}P.value=[],i.forEach(a=>{let m=110;a.rare=="SR"?m=90:a.rare=="R"&&(m=70);const l=a.level/m;a.calcBaseHP=(a.hp-a.base_hp)*l+a.base_hp,a.calcBaseATK=(a.atk-a.base_atk)*l+a.base_atk});let L=n[0].order==="昇順"?1/0:-1/0;const E=async(a,m,l,d,_)=>new Promise(v=>{const D=[i[a],i[m],i[l],i[d],i[_]],s=lt(D);if(s){const b={hp:Math.round(s[0]),ehp:Math.round(s[1]),evasion:s[2],hpBuddy:s[3],increasedHpBuddy:s[4],buddy:s[5],noHpBuddy:s[6],duo:s[7],buff:s[8],debuff:s[9],maxCosmic:s[10],maxFire:s[11],maxWater:s[12],maxFlora:s[13],referenceDamage:s[14],referenceAdvantageDamage:s[15],referenceVsHiDamage:s[16],referenceVsMizuDamage:s[17],referenceVsKiDamage:s[18],chara1:s[19],chara2:s[20],chara3:s[21],chara4:s[22],chara5:s[23],simuURL:s[24],detailList:s[25]},V=b[n[0].key];(R&&V<=L||!R&&V>=L)&&P.value.push(b)}ve.value+=1,v()}),u=new Array(5).fill(f);for(let a=0;a<A;a++)u[a]=a+1;if(it.value){let a=Date.now();const m=u[0]*(u[1]-1)*(u[2]-2)*(u[3]-3);if($.value=m*(u[4]-4)/J(5-A)+m*4/J(4-A),A==5){$.value=1,await E(0,1,2,3,4),await new Promise(requestAnimationFrame);return}for(let l=0;l<u[0];l++)for(let d=l+1;d<u[1];d++)for(let _=d+1;_<u[2];_++){if(!De.value)return;for(let v=_+1;v<u[3];v++){for(let D=v+1;D<u[4];D++)await E(l,d,_,v,D),Date.now()-a>2e3&&(a=Date.now(),await p());for(const D of[l,d,_,v])await E(l,d,_,v,D),Date.now()-a>2e3&&(a=Date.now(),await p())}}}else{const a=u[0]*(u[1]-1)*(u[2]-2)*(u[3]-3);if($.value=a*(u[4]-4)/J(5-A),A==5){$.value=1,await E(0,1,2,3,4),await new Promise(requestAnimationFrame);return}let m=Date.now();for(let l=0;l<u[0];l++)for(let d=l+1;d<u[1];d++)for(let _=d+1;_<u[2];_++){if(!De.value)return;for(let v=_+1;v<u[3];v++)for(let D=v+1;D<u[4];D++)await E(l,d,_,v,D),Date.now()-m>2e3&&(m=Date.now(),await p())}}P.value.sort(Pe(n));const C=P.value.slice(0,pe.value);P.value=[...C],P.value.length>0&&(L=P.value[P.value.length-1][n[0].key])}async function Pt(t){const i={};return await Promise.all(t.map(f=>Me(Object.assign({"../assets/img/icon/ace.png":()=>c(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>c(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>c(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>c(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>c(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>c(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>c(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>c(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>c(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>c(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>c(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>c(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>c(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>c(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>c(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>c(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>c(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>c(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>c(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>c(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>c(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>c(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>c(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>c(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>c(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>c(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>c(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>c(()=>import("./vil-5fff0695.js"),[],import.meta.url)}),`../assets/img/icon/${f.name_en}.png`).then(o=>{i[f.name_en]=o.default}).catch(()=>{i[f.name_en]=""}))),i}export{Dt as a,Oe as b,pt as c,_t as d,vt as e,Pt as f,st as g,Se as u};
