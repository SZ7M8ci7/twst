import{d as ne,r as v,e as ue,R as _e,ah as e,aY as ce,o as n,c as me,w as c,a,h as u,b as p,t as d,l as g,j as _,k as T,F as L,aj as Y,y as I,V as N,b9 as F,_ as de}from"./index-faf701b9.js";import{u as pe,_ as G}from"./characters-eed6ad5f.js";import{c as B,V as q}from"./VDialog-c719998e.js";import{f as ve}from"./common-7e2abb9d.js";import{V as fe,a as ge}from"./VRow-174893dd.js";import{V as Q,a as W}from"./VCard-3adec7ff.js";import{V as X,a as Ee}from"./VCardText-bbe7f67e.js";import{V as Z}from"./VSpacer-875a7b0a.js";import{V as Ae}from"./VContainer-3c94eacf.js";const Ve={class:"reset-area"},Ce={class:"reset-container"},Ie={class:"reset-btn-wrapper"},Te={class:"elapsed-time"},Le={class:"character-selection-area"},Re={class:"character-column"},he=["onClick"],De=["src","alt"],Oe={key:1,class:"empty-slot"},Pe=["onClick"],ke={class:"input-fields"},Se={class:"input-row"},be={class:"custom-select"},ye=["onClick"],we=["src","alt"],$e={key:1,class:"dropdown-icon"},Ue={key:0,class:"select-options"},Ne=["onClick"],Fe=["src","alt"],je={class:"input-with-counter"},Me={class:"input-row"},ze={class:"custom-select"},Be=["onClick"],Je=["src","alt"],He={key:1,class:"dropdown-icon"},Ke={key:0,class:"select-options"},Ye=["onClick"],Ge=["src","alt"],qe={class:"input-with-counter"},Qe={key:0,class:"input-row"},We={class:"custom-select"},Xe=["onClick"],Ze=["src","alt"],xe={key:1,class:"dropdown-icon"},et={key:0,class:"select-options"},tt=["onClick"],it=["src","alt"],ot={class:"input-with-counter"},lt={key:1,class:"input-row"},st={class:"custom-select"},at=["onClick"],rt=["src","alt"],nt={key:1,class:"dropdown-icon"},ut={key:0,class:"select-options"},_t=["onClick"],ct=["src","alt"],mt={class:"input-with-counter"},dt={class:"character-grid"},pt=["onClick"],vt=["src","alt"],ft={class:"clear-storage-area"},gt=ne({__name:"retire",setup(Et){const x=pe(),J=v(!0),R=v(!1),j=v(-1),A=v([null,null,null,null,null]),H=v({}),m={INPUT_VALUES:"retire_input_values",SELECTED_CHARACTERS:"retire_selected_characters",VISIBLE_FIELDS:"retire_visible_fields",RESET_COUNT:"retire_reset_count",LAST_RESET_TIME:"retire_last_reset_time"},V=v([{name:"火",value:"fire",icon:""},{name:"水",value:"water",icon:""},{name:"木",value:"flora",icon:""},{name:"無",value:"cosmic",icon:""}]),s=v([{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0}]),C=v(""),E=v([2,2,2,2,2]),h=v(0),O=v(0);let M=null;const D=v(!1),K=()=>{const i=localStorage.getItem(m.LAST_RESET_TIME);if(i){const l=Math.floor((Date.now()-parseInt(i))/1e3);O.value=l}},ee=()=>{try{const i=localStorage.getItem(m.INPUT_VALUES),l=localStorage.getItem(m.SELECTED_CHARACTERS),r=localStorage.getItem(m.VISIBLE_FIELDS),t=localStorage.getItem(m.RESET_COUNT),$=localStorage.getItem(m.LAST_RESET_TIME);if(i&&(s.value=JSON.parse(i)),l){const U=JSON.parse(l);A.value=U.map(o=>o?{...o,imgUrl:H.value[o.name_en]||""}:null)}r&&(E.value=JSON.parse(r)),t&&(h.value=parseInt(t)),$&&K()}catch(i){console.error("ローカルストレージからの読み込みに失敗しました:",i)}},f=()=>{try{localStorage.setItem(m.INPUT_VALUES,JSON.stringify(s.value)),localStorage.setItem(m.SELECTED_CHARACTERS,JSON.stringify(A.value)),localStorage.setItem(m.VISIBLE_FIELDS,JSON.stringify(E.value)),localStorage.setItem(m.RESET_COUNT,h.value.toString())}catch(i){console.error("ローカルストレージへの保存に失敗しました:",i)}},te=ue(()=>J.value?[]:B.filter(i=>i.imgUrl)),ie=i=>{j.value=i,R.value=!0},oe=i=>{j.value>=0&&(A.value[j.value]=i,f()),R.value=!1},P=(i,l)=>{const r=`${i}-${l}`;C.value=C.value===r?"":r},k=(i,l,r)=>{const t=`${l}Attribute`;s.value[i][t]=r,C.value="",f()},S=i=>{const l=V.value.find(r=>r.value===i);return(l==null?void 0:l.icon)||""},b=i=>{const l=V.value.find(r=>r.value===i);return(l==null?void 0:l.name)||""},y=(i,l)=>{const r=`${l}Count`,t=s.value[i][r];s.value[i][r]=t+1,f()},w=(i,l)=>{const r=`${l}Count`;s.value[i][r]=0,f()},le=i=>{E.value[i]<4&&(E.value[i]++,f())},se=()=>{s.value.forEach((i,l)=>{s.value[l].field1Count=0,s.value[l].field2Count=0,s.value[l].field3Count=0,s.value[l].field4Count=0}),h.value++,O.value=0,localStorage.setItem(m.LAST_RESET_TIME,Date.now().toString()),f()},ae=()=>{try{localStorage.removeItem(m.INPUT_VALUES),localStorage.removeItem(m.SELECTED_CHARACTERS),localStorage.removeItem(m.VISIBLE_FIELDS),localStorage.removeItem(m.RESET_COUNT),localStorage.removeItem(m.LAST_RESET_TIME),s.value=s.value.map(()=>({field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0})),A.value=[null,null,null,null,null],E.value=[2,2,2,2,2],h.value=0,O.value=0}catch(i){console.error("ローカルストレージのクリアに失敗しました:",i)}},re=()=>{ae(),D.value=!1};return _e(async()=>{try{await Promise.all(V.value.map(async i=>{const l=await G(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${i.value}.png`);i.icon=l.default})),H.value=await ve(B),await Promise.all(B.map(i=>G(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${i.name_en}.png`).then(l=>{i.imgUrl=l.default}).catch(()=>{i.imgUrl=""}))),ee(),M=window.setInterval(K,1e3)}finally{J.value=!1}x.handlePageChange("retirePage")}),ce(()=>{M!==null&&clearInterval(M)}),(i,l)=>(n(),me(Ae,null,{default:c(()=>[a("div",Ve,[a("div",Ce,[a("div",Ie,[u(g,{class:"reset-btn",size:"small",onClick:se},{default:c(()=>[p(d(i.$t("retire.reset"))+" ("+d(h.value)+d(i.$t("retire.num"))+") ",1)]),_:1})]),a("span",Te,d(O.value)+" "+d(i.$t("retire.seconds")),1)])]),u(ge,null,{default:c(()=>[u(fe,{cols:"12",class:"d-flex justify-center"},{default:c(()=>[a("div",Le,[(n(),_(L,null,T(5,(r,t)=>{var $,U;return a("div",{key:t,class:"character-row"},[a("div",Re,[a("div",{class:"character-slot",onClick:o=>ie(t)},[A.value[t]?(n(),_("img",{key:0,src:($=A.value[t])==null?void 0:$.imgUrl,alt:(U=A.value[t])==null?void 0:U.name_en,class:"character-image"},null,8,De)):(n(),_("div",Oe,[u(Y,null,{default:c(()=>[p("mdi-plus")]),_:1})]))],8,he),E.value[t]<4?(n(),_("div",{key:0,class:"add-field-btn",onClick:o=>le(t)},[u(Y,{size:"small"},{default:c(()=>[p("mdi-plus")]),_:1})],8,Pe)):I("",!0)]),a("div",ke,[a("div",Se,[a("div",be,[a("div",{class:"select-header",onClick:o=>P(t,"field1")},[s.value[t].field1Attribute?(n(),_("img",{key:0,src:S(s.value[t].field1Attribute),alt:b(s.value[t].field1Attribute),class:"attribute-icon"},null,8,we)):(n(),_("span",$e,"▽"))],8,ye),C.value===`${t}-field1`?(n(),_("div",Ue,[(n(!0),_(L,null,T(V.value,o=>(n(),_("div",{key:o.value,class:"select-option",onClick:z=>k(t,"field1",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,Fe)],8,Ne))),128))])):I("",!0)]),a("div",je,[u(N,{modelValue:s.value[t].field1,"onUpdate:modelValue":[o=>s.value[t].field1=o,f],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(g,{size:"small",class:"counter-btn",onClick:o=>y(t,"field1"),onContextmenu:F(o=>w(t,"field1"),["prevent"])},{default:c(()=>[p(d(s.value[t].field1Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),a("div",Me,[a("div",ze,[a("div",{class:"select-header",onClick:o=>P(t,"field2")},[s.value[t].field2Attribute?(n(),_("img",{key:0,src:S(s.value[t].field2Attribute),alt:b(s.value[t].field2Attribute),class:"attribute-icon"},null,8,Je)):(n(),_("span",He,"▽"))],8,Be),C.value===`${t}-field2`?(n(),_("div",Ke,[(n(!0),_(L,null,T(V.value,o=>(n(),_("div",{key:o.value,class:"select-option",onClick:z=>k(t,"field2",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,Ge)],8,Ye))),128))])):I("",!0)]),a("div",qe,[u(N,{modelValue:s.value[t].field2,"onUpdate:modelValue":[o=>s.value[t].field2=o,f],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(g,{size:"small",class:"counter-btn",onClick:o=>y(t,"field2"),onContextmenu:F(o=>w(t,"field2"),["prevent"])},{default:c(()=>[p(d(s.value[t].field2Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),E.value[t]>=3?(n(),_("div",Qe,[a("div",We,[a("div",{class:"select-header",onClick:o=>P(t,"field3")},[s.value[t].field3Attribute?(n(),_("img",{key:0,src:S(s.value[t].field3Attribute),alt:b(s.value[t].field3Attribute),class:"attribute-icon"},null,8,Ze)):(n(),_("span",xe,"▽"))],8,Xe),C.value===`${t}-field3`?(n(),_("div",et,[(n(!0),_(L,null,T(V.value,o=>(n(),_("div",{key:o.value,class:"select-option",onClick:z=>k(t,"field3",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,it)],8,tt))),128))])):I("",!0)]),a("div",ot,[u(N,{modelValue:s.value[t].field3,"onUpdate:modelValue":[o=>s.value[t].field3=o,f],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(g,{size:"small",class:"counter-btn",onClick:o=>y(t,"field3"),onContextmenu:F(o=>w(t,"field3"),["prevent"])},{default:c(()=>[p(d(s.value[t].field3Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):I("",!0),E.value[t]>=4?(n(),_("div",lt,[a("div",st,[a("div",{class:"select-header",onClick:o=>P(t,"field4")},[s.value[t].field4Attribute?(n(),_("img",{key:0,src:S(s.value[t].field4Attribute),alt:b(s.value[t].field4Attribute),class:"attribute-icon"},null,8,rt)):(n(),_("span",nt,"▽"))],8,at),C.value===`${t}-field4`?(n(),_("div",ut,[(n(!0),_(L,null,T(V.value,o=>(n(),_("div",{key:o.value,class:"select-option",onClick:z=>k(t,"field4",o.value)},[a("img",{src:o.icon,alt:o.name,class:"attribute-icon"},null,8,ct)],8,_t))),128))])):I("",!0)]),a("div",mt,[u(N,{modelValue:s.value[t].field4,"onUpdate:modelValue":[o=>s.value[t].field4=o,f],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(g,{size:"small",class:"counter-btn",onClick:o=>y(t,"field4"),onContextmenu:F(o=>w(t,"field4"),["prevent"])},{default:c(()=>[p(d(s.value[t].field4Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):I("",!0)])])}),64))])]),_:1})]),_:1}),u(q,{modelValue:R.value,"onUpdate:modelValue":l[1]||(l[1]=r=>R.value=r),"max-width":"800px"},{default:c(()=>[u(Q,null,{default:c(()=>[u(X,null,{default:c(()=>[a("div",dt,[(n(!0),_(L,null,T(te.value,r=>(n(),_("div",{key:r.name_en,class:"character-item",onClick:t=>oe(r)},[a("img",{src:r.imgUrl,alt:r.name_en,class:"character-image"},null,8,vt)],8,pt))),128))])]),_:1}),u(W,null,{default:c(()=>[u(Z),u(g,{color:"primary",onClick:l[0]||(l[0]=r=>R.value=!1)},{default:c(()=>[p("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",ft,[u(g,{class:"clear-storage-btn",size:"small",onClick:l[2]||(l[2]=r=>D.value=!0)},{default:c(()=>[p(d(i.$t("retire.clear_content")),1)]),_:1})]),u(q,{modelValue:D.value,"onUpdate:modelValue":l[4]||(l[4]=r=>D.value=r),"max-width":"400"},{default:c(()=>[u(Q,null,{default:c(()=>[u(Ee,{class:"text-h5"},{default:c(()=>[p(d(i.$t("retire.confirm_clear")),1)]),_:1}),u(X,null,{default:c(()=>[p(d(i.$t("retire.confirm_clear_message")),1)]),_:1}),u(W,null,{default:c(()=>[u(Z),u(g,{color:"grey-darken-1",variant:"text",onClick:l[3]||(l[3]=r=>D.value=!1)},{default:c(()=>[p(d(i.$t("retire.cancel")),1)]),_:1}),u(g,{color:"error",variant:"text",onClick:re},{default:c(()=>[p(d(i.$t("retire.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});const Ot=de(gt,[["__scopeId","data-v-8a392161"]]);export{Ot as default};
