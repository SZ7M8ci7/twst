import{u as re}from"./characters-cb31a948.js";import{G as de,r as o,d as ce,i as ve,v as Q,e as X,C as fe,aO as me,o as r,j as d,a as u,h as _,w as g,b as k,t as W,u as S,l as C,F as h,k as y,au as Y,at as pe,p as _e,n as Se,_ as he}from"./index-be69d6b6.js";import{c as x}from"./characters_info-cf66bb8a.js";import{f as ye}from"./common-3b4c0717.js";import{V}from"./VCheckbox-b40ed1f1.js";const be=de("filterd",()=>{const b=o([]),A=o([]),a=o(!0),U=o([]),O=o([]),F=o([]);return{tempSelectedCharacters:b,tempSelectedRare:A,isFirst:a,tempSelectedType:U,tempSelectedAttr:O,tempSelectedEffects:F}}),le=b=>(_e("data-v-39b83784"),b=b(),Se(),b),Me={class:"modal-background",ref:"modalContainer"},ge={class:"feature-select-all-container"},ke={class:"feature-items"},We=le(()=>u("hr",{class:"rare-divider"},null,-1)),Ce={class:"display-block"},Re={class:"character-list-wrapper"},we={class:"character-select-all-container"},Ve={class:"character-items"},Ae=["onClick"],Ue=["src","alt"],Oe=le(()=>u("hr",{class:"rare-divider"},null,-1)),Fe={class:"feature-select-all-container"},Pe={class:"feature-items"},$e={class:"button-container"},Z=50,ee=10,Be=ce({__name:"FilterModal",emits:["close"],setup(b,{emit:A}){const{t:a}=ve(),U=re(),{characters:O}=Q(U),F=be(),{tempSelectedCharacters:P,tempSelectedRare:$,tempSelectedType:B,tempSelectedAttr:D,tempSelectedEffects:E,isFirst:G}=Q(F),i=o([]),v=o([]),p=o([]),c=o([]),f=o([]),te=A,I=o(0),L=o({}),ae=o({"--icon-size":`${Z}px`,"--gap-size":`${ee}px`}),j=["SSR","SR","R"],H=X(()=>[{name:a("filterModal.balance"),value:"バランス"},{name:a("filterModal.defence"),value:"ディフェンス"},{name:a("filterModal.attack"),value:"アタック"}]),K=X(()=>[{name:a("filterModal.fire"),value:"火"},{name:a("filterModal.water"),value:"水"},{name:a("filterModal.flora"),value:"木"},{name:a("filterModal.cosmic"),value:"無"}]),R=[{name:a("filterModal.power_boost"),value:"ATKUP"},{name:a("filterModal.damage_boost"),value:"ダメージUP"},{name:a("filterModal.critical"),value:"クリティカル"},{name:a("filterModal.element_boost"),value:"属性ダメージUP"},{name:a("filterModal.damage_vulnerability"),value:"被ダメージUP"},{name:a("filterModal.power_cut"),value:"ATKDOWN"},{name:a("filterModal.damage_cut"),value:"ダメージDOWN"},{name:a("filterModal.evasion"),value:"回避"},{name:a("filterModal.element_cut"),value:"属性ダメージDOWN"},{name:a("filterModal.resistence"),value:"被ダメージDOWN"},{name:a("filterModal.hp_restoration"),value:"HP回復"},{name:a("filterModal.hp_regen"),value:"HP継続回復"},{name:a("filterModal.nullifies_blind"),value:"暗闇無効"},{name:a("filterModal.nullifies_curse"),value:"呪い無効"},{name:a("filterModal.nullifies_freeze"),value:"凍結無効"},{name:a("filterModal.debuff_removal"),value:"デバフ解除"},{name:a("filterModal.curse"),value:"呪い"}],M=x.reduce((e,t)=>{const l=t.dorm;return e[l]||(e[l]=[]),e[l].push(t),e},{}),N=()=>{const e=document.querySelector(".display-block");e&&(I.value=e.clientWidth)},q=()=>{N()};fe(async()=>{G.value?(i.value=Object.values(M).flat().map(e=>e.name_en),v.value=["SSR","SR","R"],p.value=["バランス","ディフェンス","アタック"],c.value=["火","水","木","無"],f.value=["ATKUP","ダメージUP","クリティカル","属性ダメージUP","被ダメージUP","ATKDOWN","ダメージDOWN","回避","属性ダメージDOWN","被ダメージDOWN","HP回復","HP継続回復","暗闇無効","呪い無効","凍結無効","デバフ解除","呪い"]):(P.value.length>0&&(i.value=[...P.value]),$.value.length>0&&(v.value=[...$.value]),B.value.length>0&&(p.value=[...B.value]),D.value.length>0&&(c.value=[...D.value]),E.value.length>0&&(f.value=[...E.value])),G.value=!1,N(),window.addEventListener("resize",q),L.value=await ye(x)}),me(()=>{window.removeEventListener("resize",q)});function se(){P.value=[...i.value],$.value=[...v.value],B.value=[...p.value],D.value=[...c.value],E.value=[...f.value],O.value.forEach(e=>{if(!v.value.includes(e.rare)){e.visible=!1;return}const t=x.find(l=>l.name_ja===e.chara||l.name_en===e.chara);if(!t||!i.value.includes(t.name_en)){e.visible=!1;return}if(!p.value.includes(e.attr)){e.visible=!1;return}if(!c.value.includes(e.magic1atr)&&!c.value.includes(e.magic2atr)&&!c.value.includes(e.magic3atr)){e.visible=!1;return}if(f.value.length===17)e.visible=!0;else if(!f.value.some(s=>e.etc.includes(s))){e.visible=!1;return}}),te("close")}function T(e){if(e==="statusEffects")R.every(l=>f.value.includes(l.value))?f.value=[]:f.value=R.map(l=>l.value);else if(e==="cardAttributes"){const t=["SSR","SR","R"].every(n=>v.value.includes(n)),l=["バランス","ディフェンス","アタック"].every(n=>p.value.includes(n)),s=["火","水","木","無"].every(n=>c.value.includes(n));t&&l&&s?(v.value=[],p.value=[],c.value=[]):(v.value=["SSR","SR","R"],p.value=["バランス","ディフェンス","アタック"],c.value=["火","水","木","無"])}else{const t=M[e]||[];t.every(s=>i.value.includes(s.name_en))?i.value=i.value.filter(s=>!t.some(n=>n.name_en===s)):i.value=[...new Set([...i.value,...t.map(s=>s.name_en)])]}}function z(e){return e==="cardAttributes"?j.every(l=>v.value.includes(l))&&H.value.every(l=>p.value.includes(l.value))&&K.value.every(l=>c.value.includes(l.value)):e==="statusEffects"?R.every(l=>f.value.includes(l.value)):M[e].every(l=>i.value.includes(l.name_en))}function ne(e){i.value=i.value.includes(e)?i.value.filter(t=>t!==e):[...i.value,e]}const ie=e=>64+(Z+10+ee)*e.length+10,ue=e=>({width:e===1?"100%":"50%"}),oe=()=>{const e=[];let t=[],l=0;const s=I.value,n=2;return Object.entries(M).forEach(([m,J])=>{const w=ie(J);w>=s/n?(t.length>0&&(e.push(t),t=[],l=0),e.push([m])):l+w<=s&&t.length<n?(t.push(m),l+=w):(e.push(t),t=[m],l=w)}),t.length>0&&e.push(t),e};return(e,t)=>(r(),d("div",Me,[u("div",ge,[_(C,{small:"",onClick:t[0]||(t[0]=l=>T("cardAttributes"))},{default:g(()=>[k(W(z("cardAttributes")?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:1}),u("div",ke,[(r(),d(h,null,y(j,(l,s)=>u("div",{class:"feature-item",key:`rare-${s}`},[_(V,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=n=>v.value=n),value:l,label:l,"hide-details":""},null,8,["modelValue","value","label"])])),64)),(r(!0),d(h,null,y(H.value,(l,s)=>(r(),d("div",{class:"feature-item",key:`type-${s}`},[_(V,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=n=>p.value=n),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])]))),128)),(r(!0),d(h,null,y(K.value,(l,s)=>(r(),d("div",{class:"feature-item",key:`attr-${s}`},[_(V,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=n=>c.value=n),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])]))),128))])]),We,u("div",Ce,[u("div",Re,[(r(!0),d(h,null,y(oe(),(l,s)=>(r(),d("div",{key:s,class:"row"},[(r(!0),d(h,null,y(l,n=>(r(),d("div",{key:n,style:Y(ue(l.length)),class:"character-list"},[u("div",we,[_(C,{small:"",onClick:m=>T(n)},{default:g(()=>[k(W(z(n)?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:2},1032,["onClick"]),u("div",Ve,[(r(!0),d(h,null,y(S(M)[n],m=>(r(),d("div",{key:m.name_en,class:pe(["character-item",{selected:i.value.includes(m.name_en)}]),onClick:J=>ne(m.name_en),style:Y({...ae.value,opacity:i.value.includes(m.name_en)?1:.5})},[u("img",{src:L.value[m.name_en],alt:m.name_en,class:"character-image"},null,8,Ue)],14,Ae))),128))])])],4))),128))]))),128))])]),Oe,u("div",Fe,[_(C,{small:"",onClick:t[4]||(t[4]=l=>T("statusEffects"))},{default:g(()=>[k(W(z("statusEffects")?S(a)("filterModal.release"):S(a)("filterModal.select")),1)]),_:1}),u("div",Pe,[(r(),d(h,null,y(R,l=>u("div",{key:l.name,class:"feature-item"},[_(V,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=s=>f.value=s),value:l.value,label:l.name,"hide-details":""},null,8,["modelValue","value","label"])])),64))])]),u("div",$e,[_(C,{class:"button",onClick:t[6]||(t[6]=l=>e.$emit("close"))},{default:g(()=>[k(W(e.$t("filterModal.cancel")),1)]),_:1}),_(C,{class:"button apply-button",disabled:i.value.length===0||v.value.length===0,onClick:se},{default:g(()=>[k(W(e.$t("filterModal.submit")),1)]),_:1},8,["disabled"])])],512))}});const Ge=he(Be,[["__scopeId","data-v-39b83784"]]);export{Ge as F};
