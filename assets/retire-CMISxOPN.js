import{d as ne,r as v,e as ue,A as _e,z as e,aq as me,c as ce,w as m,a,g as u,b as p,t as d,l as f,j as _,k as L,F as R,o as n,v as T,E as G,V as j,b4 as z,_ as de}from"./index-Cl7UdGAI.js";import{b as pe,_ as Y,l as ve}from"./common-Bd-tWdsR.js";import{c as H,V as Q}from"./characters_info-D8d6aZqj.js";import{V as ge,a as fe}from"./VRow-BBIF7ql9.js";import{V as W,a as X}from"./VCard-CekdwCt4.js";import{V as Z,a as Ee}from"./VCardText-C8R3KDWZ.js";import{V as F}from"./VSpacer-G9RBN9yx.js";import{V as Ae}from"./VContainer-0dPynjQi.js";const Ve={class:"reset-area"},Ce={class:"reset-container"},Ie={class:"reset-btn-wrapper"},Te={class:"elapsed-time"},Le={class:"character-selection-area"},Re={class:"character-column"},De=["onClick"],Oe=["src","alt"],Pe={key:1,class:"empty-slot"},he=["onClick"],ke={class:"input-fields"},Se={class:"input-row"},be={class:"custom-select"},ye=["onClick"],we=["src","alt"],$e={key:1,class:"dropdown-icon"},Ue={key:0,class:"select-options"},Ne=["onClick"],je=["src","alt"],ze={class:"input-with-counter"},Me={class:"input-row"},Be={class:"custom-select"},Je=["onClick"],He=["src","alt"],Ke={key:1,class:"dropdown-icon"},qe={key:0,class:"select-options"},Ge=["onClick"],Ye=["src","alt"],Qe={class:"input-with-counter"},We={key:0,class:"input-row"},Xe={class:"custom-select"},Ze=["onClick"],Fe=["src","alt"],xe={key:1,class:"dropdown-icon"},et={key:0,class:"select-options"},tt=["onClick"],it=["src","alt"],ot={class:"input-with-counter"},lt={key:1,class:"input-row"},st={class:"custom-select"},at=["onClick"],rt=["src","alt"],nt={key:1,class:"dropdown-icon"},ut={key:0,class:"select-options"},_t=["onClick"],mt=["src","alt"],ct={class:"input-with-counter"},dt={class:"character-grid"},pt=["onClick"],vt=["src","alt"],gt={class:"clear-storage-area"},ft=ne({__name:"retire",setup(Et){const x=pe(),K=v(!0),D=v(!1),M=v(-1),A=v([null,null,null,null,null]),B=v({}),c={INPUT_VALUES:"retire_input_values",SELECTED_CHARACTERS:"retire_selected_characters",VISIBLE_FIELDS:"retire_visible_fields",RESET_COUNT:"retire_reset_count",LAST_RESET_TIME:"retire_last_reset_time"},V=v([{name:"火",value:"fire",icon:""},{name:"水",value:"water",icon:""},{name:"木",value:"flora",icon:""},{name:"無",value:"cosmic",icon:""}]),s=v([{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0},{field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0}]),C=v(""),E=v([2,2,2,2,2]),O=v(0),h=v(0);let J=null;const P=v(!1),q=()=>{const o=localStorage.getItem(c.LAST_RESET_TIME);if(o){const l=Math.floor((Date.now()-parseInt(o))/1e3);h.value=l}},ee=()=>{try{const o=localStorage.getItem(c.INPUT_VALUES),l=localStorage.getItem(c.SELECTED_CHARACTERS),r=localStorage.getItem(c.VISIBLE_FIELDS),t=localStorage.getItem(c.RESET_COUNT),U=localStorage.getItem(c.LAST_RESET_TIME);if(o&&(s.value=JSON.parse(o)),l){const N=JSON.parse(l);A.value=N.map(i=>{if(!i)return null;let I="";return i.imgUrl?I=i.imgUrl:i.name_en&&B.value[i.name_en]&&(I=B.value[i.name_en]),{name_ja:i.name_ja,name_en:i.name_en,dorm:i.dorm,theme_1:i.theme_1,theme_2:i.theme_2,imgUrl:I}})}r&&(E.value=JSON.parse(r)),t&&(O.value=parseInt(t)),U&&q()}catch(o){console.error("ローカルストレージからの読み込みに失敗しました:",o)}},g=()=>{try{localStorage.setItem(c.INPUT_VALUES,JSON.stringify(s.value)),localStorage.setItem(c.SELECTED_CHARACTERS,JSON.stringify(A.value)),localStorage.setItem(c.VISIBLE_FIELDS,JSON.stringify(E.value)),localStorage.setItem(c.RESET_COUNT,O.value.toString())}catch(o){console.error("ローカルストレージへの保存に失敗しました:",o)}},te=ue(()=>K.value?[]:H.filter(o=>o.imgUrl)),ie=o=>{M.value=o,D.value=!0},oe=o=>{M.value>=0&&(A.value[M.value]=o,g()),D.value=!1},k=(o,l)=>{const r=`${o}-${l}`;C.value=C.value===r?"":r},S=(o,l,r)=>{const t=`${l}Attribute`;s.value[o][t]=r,C.value="",g()},b=o=>{const l=V.value.find(r=>r.value===o);return(l==null?void 0:l.icon)||""},y=o=>{const l=V.value.find(r=>r.value===o);return(l==null?void 0:l.name)||""},w=(o,l)=>{const r=`${l}Count`,t=s.value[o][r];s.value[o][r]=t+1,g()},$=(o,l)=>{const r=`${l}Count`;s.value[o][r]=0,g()},le=o=>{E.value[o]<4&&(E.value[o]++,g())},se=()=>{s.value.forEach((o,l)=>{s.value[l].field1Count=0,s.value[l].field2Count=0,s.value[l].field3Count=0,s.value[l].field4Count=0}),O.value++,h.value=0,localStorage.setItem(c.LAST_RESET_TIME,Date.now().toString()),g()},ae=()=>{try{localStorage.removeItem(c.INPUT_VALUES),localStorage.removeItem(c.SELECTED_CHARACTERS),localStorage.removeItem(c.VISIBLE_FIELDS),localStorage.removeItem(c.RESET_COUNT),localStorage.removeItem(c.LAST_RESET_TIME),s.value=s.value.map(()=>({field1:"",field2:"",field3:"",field4:"",field1Attribute:"",field2Attribute:"",field3Attribute:"",field4Attribute:"",field1Count:0,field2Count:0,field3Count:0,field4Count:0})),A.value=[null,null,null,null,null],E.value=[2,2,2,2,2],O.value=0,h.value=0}catch(o){console.error("ローカルストレージのクリアに失敗しました:",o)}},re=()=>{ae(),P.value=!1};return _e(async()=>{try{await Promise.all(V.value.map(async o=>{const l=await Y(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-C21uDqJI.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-CVW4DDae.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-dHQC9vvf.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-DKaHgH9c.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-9v79z8xw.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-CFrggm8P.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-BZCNAvHk.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-XvRajI-_.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-rbBSpQaR.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-DfZlWO8v.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-Dtbzp4jN.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-3QzKnPd_.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-BaKBQzvn.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-BDqkDmnL.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-DeLuIR_V.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-D0jskeDu.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-gV4WyIdO.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-Dbn_Pw_c.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-S4ZGIsV1.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-BYLMHMYS.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-DY_k0GLT.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-2kdkTn0A.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-CS8psqz3.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-PNie2Mf_.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-DUPZX0VU.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-DnUDlWQI.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-DUETjxHp.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-B7L_xJAP.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-B8Xb3_tL.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-C1WCdnnm.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-C8N6AbLT.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-Bm78Orf8.js"),[],import.meta.url)}),`../assets/img/icon/${o.value}.png`,5);o.icon=l.default})),B.value=await ve(H,o=>o.name_en),await Promise.all(H.map(o=>Y(Object.assign({"../assets/img/icon/ace.png":()=>e(()=>import("./ace-C21uDqJI.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>e(()=>import("./azul-CVW4DDae.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>e(()=>import("./cater-dHQC9vvf.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>e(()=>import("./cosmic-DKaHgH9c.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>e(()=>import("./crewel-9v79z8xw.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>e(()=>import("./crowley-CFrggm8P.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>e(()=>import("./deuce-BZCNAvHk.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>e(()=>import("./epel-XvRajI-_.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>e(()=>import("./fellow-rbBSpQaR.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>e(()=>import("./fire-DfZlWO8v.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>e(()=>import("./flora-Dtbzp4jN.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>e(()=>import("./floyd-3QzKnPd_.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>e(()=>import("./grim-BaKBQzvn.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>e(()=>import("./idia-BDqkDmnL.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>e(()=>import("./jack-DeLuIR_V.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>e(()=>import("./jade-D0jskeDu.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>e(()=>import("./jamil-gV4WyIdO.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>e(()=>import("./kalim-Dbn_Pw_c.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>e(()=>import("./leona-S4ZGIsV1.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>e(()=>import("./lilia-BYLMHMYS.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>e(()=>import("./malleus-DY_k0GLT.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>e(()=>import("./ortho-2kdkTn0A.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>e(()=>import("./riddle-CS8psqz3.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>e(()=>import("./rollo-PNie2Mf_.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>e(()=>import("./rook-DUPZX0VU.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>e(()=>import("./ruggie-DnUDlWQI.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>e(()=>import("./sebek-DUETjxHp.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>e(()=>import("./silver-B7L_xJAP.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>e(()=>import("./train-B8Xb3_tL.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>e(()=>import("./trey-C1WCdnnm.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>e(()=>import("./vil-C8N6AbLT.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>e(()=>import("./water-Bm78Orf8.js"),[],import.meta.url)}),`../assets/img/icon/${o.name_en}.png`,5).then(l=>{o.imgUrl=l.default}).catch(()=>{o.imgUrl=""}))),ee(),J=window.setInterval(q,1e3)}finally{K.value=!1}x.handlePageChange("retirePage")}),me(()=>{J!==null&&clearInterval(J)}),(o,l)=>(n(),ce(Ae,null,{default:m(()=>[a("div",Ve,[a("div",Ce,[a("div",Ie,[u(f,{class:"reset-btn",size:"small",onClick:se},{default:m(()=>[p(d(o.$t("retire.reset"))+" ("+d(O.value)+d(o.$t("retire.num"))+") ",1)]),_:1})]),a("span",Te,d(h.value)+" "+d(o.$t("retire.seconds")),1)])]),u(fe,null,{default:m(()=>[u(ge,{cols:"12",class:"d-flex justify-center"},{default:m(()=>[a("div",Le,[(n(),_(R,null,L(5,(r,t)=>{var U,N;return a("div",{key:t,class:"character-row"},[a("div",Re,[a("div",{class:"character-slot",onClick:i=>ie(t)},[A.value[t]?(n(),_("img",{key:0,src:(U=A.value[t])==null?void 0:U.imgUrl,alt:(N=A.value[t])==null?void 0:N.name_en,class:"character-image"},null,8,Oe)):(n(),_("div",Pe,[u(G,null,{default:m(()=>l[5]||(l[5]=[p("mdi-plus",-1)])),_:1,__:[5]})]))],8,De),E.value[t]<4?(n(),_("div",{key:0,class:"add-field-btn",onClick:i=>le(t)},[u(G,{size:"small"},{default:m(()=>l[6]||(l[6]=[p("mdi-plus",-1)])),_:1,__:[6]})],8,he)):T("",!0)]),a("div",ke,[a("div",Se,[a("div",be,[a("div",{class:"select-header",onClick:i=>k(t,"field1")},[s.value[t].field1Attribute?(n(),_("img",{key:0,src:b(s.value[t].field1Attribute),alt:y(s.value[t].field1Attribute),class:"attribute-icon"},null,8,we)):(n(),_("span",$e,"▽"))],8,ye),C.value===`${t}-field1`?(n(),_("div",Ue,[(n(!0),_(R,null,L(V.value,i=>(n(),_("div",{key:i.value,class:"select-option",onClick:I=>S(t,"field1",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,je)],8,Ne))),128))])):T("",!0)]),a("div",ze,[u(j,{modelValue:s.value[t].field1,"onUpdate:modelValue":[i=>s.value[t].field1=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field1"),onContextmenu:z(i=>$(t,"field1"),["prevent"])},{default:m(()=>[p(d(s.value[t].field1Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),a("div",Me,[a("div",Be,[a("div",{class:"select-header",onClick:i=>k(t,"field2")},[s.value[t].field2Attribute?(n(),_("img",{key:0,src:b(s.value[t].field2Attribute),alt:y(s.value[t].field2Attribute),class:"attribute-icon"},null,8,He)):(n(),_("span",Ke,"▽"))],8,Je),C.value===`${t}-field2`?(n(),_("div",qe,[(n(!0),_(R,null,L(V.value,i=>(n(),_("div",{key:i.value,class:"select-option",onClick:I=>S(t,"field2",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,Ye)],8,Ge))),128))])):T("",!0)]),a("div",Qe,[u(j,{modelValue:s.value[t].field2,"onUpdate:modelValue":[i=>s.value[t].field2=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field2"),onContextmenu:z(i=>$(t,"field2"),["prevent"])},{default:m(()=>[p(d(s.value[t].field2Count),1)]),_:2},1032,["onClick","onContextmenu"])])]),E.value[t]>=3?(n(),_("div",We,[a("div",Xe,[a("div",{class:"select-header",onClick:i=>k(t,"field3")},[s.value[t].field3Attribute?(n(),_("img",{key:0,src:b(s.value[t].field3Attribute),alt:y(s.value[t].field3Attribute),class:"attribute-icon"},null,8,Fe)):(n(),_("span",xe,"▽"))],8,Ze),C.value===`${t}-field3`?(n(),_("div",et,[(n(!0),_(R,null,L(V.value,i=>(n(),_("div",{key:i.value,class:"select-option",onClick:I=>S(t,"field3",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,it)],8,tt))),128))])):T("",!0)]),a("div",ot,[u(j,{modelValue:s.value[t].field3,"onUpdate:modelValue":[i=>s.value[t].field3=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field3"),onContextmenu:z(i=>$(t,"field3"),["prevent"])},{default:m(()=>[p(d(s.value[t].field3Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):T("",!0),E.value[t]>=4?(n(),_("div",lt,[a("div",st,[a("div",{class:"select-header",onClick:i=>k(t,"field4")},[s.value[t].field4Attribute?(n(),_("img",{key:0,src:b(s.value[t].field4Attribute),alt:y(s.value[t].field4Attribute),class:"attribute-icon"},null,8,rt)):(n(),_("span",nt,"▽"))],8,at),C.value===`${t}-field4`?(n(),_("div",ut,[(n(!0),_(R,null,L(V.value,i=>(n(),_("div",{key:i.value,class:"select-option",onClick:I=>S(t,"field4",i.value)},[a("img",{src:i.icon,alt:i.name,class:"attribute-icon"},null,8,mt)],8,_t))),128))])):T("",!0)]),a("div",ct,[u(j,{modelValue:s.value[t].field4,"onUpdate:modelValue":[i=>s.value[t].field4=i,g],"hide-details":"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),u(f,{size:"small",class:"counter-btn",onClick:i=>w(t,"field4"),onContextmenu:z(i=>$(t,"field4"),["prevent"])},{default:m(()=>[p(d(s.value[t].field4Count),1)]),_:2},1032,["onClick","onContextmenu"])])])):T("",!0)])])}),64))])]),_:1})]),_:1}),u(Q,{modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=r=>D.value=r),"max-width":"800px"},{default:m(()=>[u(W,null,{default:m(()=>[u(Z,null,{default:m(()=>[a("div",dt,[(n(!0),_(R,null,L(te.value,r=>(n(),_("div",{key:r.name_en,class:"character-item",onClick:t=>oe(r)},[a("img",{src:r.imgUrl,alt:r.name_en,class:"character-image"},null,8,vt)],8,pt))),128))])]),_:1}),u(X,null,{default:m(()=>[u(F),u(f,{color:"primary",onClick:l[0]||(l[0]=r=>D.value=!1)},{default:m(()=>l[7]||(l[7]=[p("Close",-1)])),_:1,__:[7]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",gt,[u(f,{class:"clear-storage-btn",size:"small",onClick:l[2]||(l[2]=r=>P.value=!0)},{default:m(()=>[p(d(o.$t("retire.clear_content")),1)]),_:1})]),u(Q,{modelValue:P.value,"onUpdate:modelValue":l[4]||(l[4]=r=>P.value=r),"max-width":"400"},{default:m(()=>[u(W,null,{default:m(()=>[u(Ee,{class:"text-h5"},{default:m(()=>[p(d(o.$t("retire.confirm_clear")),1)]),_:1}),u(Z,null,{default:m(()=>[p(d(o.$t("retire.confirm_clear_message")),1)]),_:1}),u(X,null,{default:m(()=>[u(F),u(f,{color:"grey-darken-1",variant:"text",onClick:l[3]||(l[3]=r=>P.value=!1)},{default:m(()=>[p(d(o.$t("retire.cancel")),1)]),_:1}),u(f,{color:"error",variant:"text",onClick:re},{default:m(()=>[p(d(o.$t("retire.confirm")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Ot=de(ft,[["__scopeId","data-v-63565d30"]]);export{Ot as default};
