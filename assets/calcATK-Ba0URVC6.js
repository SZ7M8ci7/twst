import{C as ae,r as le,u as te,V as I,D as oe}from"./simulatorStore-BazXjcr5.js";import{d as se,i as ne,R as ue,q as ie,c as de,w as n,f as o,a as s,t as m,m as ce,V as C,b as F,bh as re,r as S,g as c,o as me,_ as ve}from"./index-JQZ9gGAJ.js";import{V as v,a as V}from"./VRow-DvSdr1wR.js";import{V as fe}from"./VContainer-C3Vuynyi.js";import"./calculations-gXkkWyKb.js";import"./handCollection-BMU9-gyV.js";const ge={class:"field-label"},pe={class:"field-label"},be={class:"field-label"},Ce={class:"field-label"},Se={class:"field-label"},Ve={class:"mdi mdi-help-circle-outline"},ke={class:"table-wrapper"},_e={class:"pa-0"},ye={class:"pa-0"},he={class:"pa-0"},Ae={class:"text-nowrap wide-cell pa-0"},qe={class:"mdi mdi-help-circle-outline"},Fe={class:"pa-0"},De={class:"pa-0"},$e={class:"pa-0"},Ue={class:"text-nowrap pa-0"},we={class:"pa-0"},Ne={class:"pa-0"},Pe={class:"pa-0"},xe=se({__name:"calcATK",props:{selectedAttribute:{}},setup(K){ae.register(...le);const{t:p}=ne(),f=te(),D=K,$=S(!1),k=S(0),_=S(0),y=S(0),h=S(0),r=S(1.5),z=[{text:"Easy",value:.8},{text:"Normal",value:1},{text:"Hard",value:1.2},{text:"Extra",value:1.5}],t=S({advantageCombo:0,equalCombo:0,disadvantageCombo:0,advantageSingle:0,equalSingle:0,disadvantageSingle:0}),U=c(()=>Number(t.value.advantageCombo)+Number(t.value.equalCombo)+Number(t.value.disadvantageCombo)+Number(t.value.advantageSingle)+Number(t.value.equalSingle)+Number(t.value.disadvantageSingle)),w=c(()=>Number((_.value/208).toFixed(0))),N=c(()=>y.value*120),P=c(()=>h.value*180),x=c(()=>t.value.advantageCombo*210),M=c(()=>t.value.equalCombo*180),O=c(()=>t.value.disadvantageCombo*150),T=c(()=>t.value.advantageSingle*150),H=c(()=>t.value.equalSingle*120),R=c(()=>t.value.disadvantageSingle*90),E=c(()=>11036+k.value*.080471),B=c(()=>641.2+k.value*.002048),G=c(()=>E.value-B.value*U.value+w.value+N.value+P.value+x.value+M.value+O.value+T.value+H.value+R.value),j=c(()=>(G.value*r.value).toFixed()),b=["#FAD9C8","#FAF2C8","#E9FAC8","#D0FAC8","#C8FAD9","#C8FAF2","#C8E9FA","#C8D0FA","#D9C8FA","#F2C8FA"],A=c(()=>[{label:p("attack.numberOfActions"),value:Number(((E.value-B.value*U.value)*r.value).toFixed()),color:b[0]},{label:p("attack.numberOfAdvantage2"),value:x.value*r.value,color:b[1]},{label:p("attack.damage"),value:w.value*r.value,color:b[2]},{label:p("attack.nullifingHPRestoration"),value:P.value*r.value,color:b[3]},{label:p("attack.numberOfDisadvantage2"),value:M.value*r.value,color:b[4]},{label:p("attack.buff"),value:N.value*r.value,color:b[5]},{label:p("attack.numberOfAdvantage1"),value:T.value*r.value,color:b[6]},{label:p("attack.numberOfNeutral2"),value:O.value*r.value,color:b[7]},{label:p("attack.numberOfDisadvantage1"),value:H.value*r.value,color:b[8]},{label:p("attack.numberOfNeutral1"),value:R.value*r.value,color:b[9]}].sort((a,e)=>e.value-a.value)),J=c(()=>({labels:A.value.map(a=>a.label),datasets:[{data:A.value.map(a=>a.value),backgroundColor:A.value.map(a=>a.color)}]}));ue(async()=>{await f.waitForDeckStats(),$.value=!0,ie(()=>[f.deckCharacters,D.selectedAttribute,f.isDeckStatsReady],()=>{$.value&&f.isDeckStatsReady&&L()},{deep:!0,immediate:!0})});async function L(){if($.value)try{const a=D.selectedAttribute||"対全",e=await f.getSafeDeckDamage(a);_.value=Math.floor(e);const l=Q();y.value=l;const u=W();h.value=Math.min(u,1);const d=X();t.value.advantageCombo=d.advantage.combo,t.value.equalCombo=d.equal.combo,t.value.disadvantageCombo=d.disadvantage.combo,t.value.advantageSingle=d.advantage.single,t.value.equalSingle=d.equal.single,t.value.disadvantageSingle=d.disadvantage.single}catch{_.value=0,y.value=0,h.value=0,t.value.advantageCombo=0,t.value.equalCombo=0,t.value.disadvantageCombo=0,t.value.advantageSingle=0,t.value.equalSingle=0,t.value.disadvantageSingle=0}}function Q(){let a=0;const e=["ATKUP","火属性ダメージUP","水属性ダメージUP","木属性ダメージUP","無属性ダメージUP","ダメージUP","クリティカル"];return(f.deckCharacters||[]).forEach(l=>{if(!(!l||!l.name||l.name===""||l.name==="なし")){for(let u=1;u<=3;u++)if(l[`isM${u}Selected`]&&f.isMagicValidForRarity(l,u)){const q=(l.etc||"").split(",").map(i=>i.trim()).filter(i=>i.includes(`(M${u})`));for(const i of q)for(const ee of e)if(i.includes(ee)){if(i.includes("被ダメージUP"))continue;if(i.includes("自")||i.includes("味方")){a++;break}}}}}),a}function W(){for(const a of f.deckCharacters||[])if(!(!a||!a.name||a.name===""||a.name==="なし")){for(let e=1;e<=3;e++)if(a[`isM${e}Selected`]&&f.isMagicValidForRarity(a,e)){const d=(a.etc||"").split(",").map(g=>g.trim()).filter(g=>g.includes(`(M${e})`));for(const g of d)if(g.includes("呪い")&&!g.includes("呪い無効"))return 1}}return 0}function X(){const a={advantage:{combo:0,single:0},equal:{combo:0,single:0},disadvantage:{combo:0,single:0}},e=D.selectedAttribute||"対全",l=e.replace("対","");return(f.deckCharacters||[]).forEach(u=>{if(!(!u||!u.name||u.name===""||u.name==="なし")){for(let d=1;d<=3;d++)if(u[`isM${d}Selected`]&&f.isMagicValidForRarity(u,d)){const g=u[`magic${d}Attribute`],q=u[`magic${d}Power`];let i;e==="対全"?g==="無"?i="equal":i="advantage":l==="無"?i="equal":Y(g,l)?i="advantage":Z(g,l)?i="disadvantage":i="equal",q==="単発(弱)"||q==="単発(強)"?a[i].single++:a[i].combo++}}}),a}function Y(a,e){return{火:"木",水:"火",木:"水"}[a]===e}function Z(a,e){return{火:"水",水:"木",木:"火"}[a]===e}return(a,e)=>(me(),de(fe,{class:"pa-2"},{default:n(()=>[o(V,{class:"ma-0"},{default:n(()=>[o(v,{cols:"12",class:"pa-0"},{default:n(()=>[o(V,{align:"center",class:"ma-0"},{default:n(()=>[o(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[s("span",ge,m(a.$t("attack.difficulty")),1)]),_:1}),o(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[o(ce,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),items:z,"item-title":"text","item-value":"value","hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),_:1})]),_:1}),o(V,{align:"center",class:"ma-0"},{default:n(()=>[o(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[s("span",pe,m(a.$t("attack.enemyHP")),1)]),_:1}),o(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[o(C,{type:"number",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=l=>k.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),o(V,{align:"center",class:"ma-0"},{default:n(()=>[o(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[s("span",be,m(a.$t("attack.totalDamageDealt")),1)]),_:1}),o(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[o(C,{type:"number",modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:k.value},null,8,["modelValue","min"])]),_:1})]),_:1}),o(V,{align:"center",class:"ma-0"},{default:n(()=>[o(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[s("span",Ce,m(a.$t("attack.buff")),1)]),_:1}),o(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[o(C,{type:"number",modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=l=>y.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),o(V,{align:"center",class:"ma-0"},{default:n(()=>[o(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[s("span",Se,[F(m(a.$t("attack.nullifingHPRestoration"))+" ",1),s("span",Ve,[o(I,{activator:"parent","open-on-click":""},{default:n(()=>[F(m(a.$t("attack.maxNum")),1)]),_:1})])])]),_:1}),o(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[o(C,{type:"number",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=l=>h.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0,max:1},null,8,["modelValue"])]),_:1})]),_:1}),o(V,{class:"ma-0"},{default:n(()=>[o(v,{class:"pa-0"},{default:n(()=>[s("div",ke,[o(re,null,{default:n(()=>[s("thead",null,[s("tr",null,[e[11]||(e[11]=s("th",null,null,-1)),s("th",_e,m(a.$t("attack.advantage")),1),s("th",ye,m(a.$t("attack.neutral")),1),s("th",he,m(a.$t("attack.disadvantage")),1)])]),s("tbody",null,[s("tr",null,[s("th",Ae,[F(m(a.$t("attack.numberOfMultihit"))+" ",1),s("span",qe,[o(I,{style:{"white-space":"nowrap"},activator:"parent","open-on-click":""},{default:n(()=>[F(m(a.$t("attack.attackDetail")),1)]),_:1})])]),s("td",Fe,[o(C,{type:"number",modelValue:t.value.advantageCombo,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.advantageCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",De,[o(C,{type:"number",modelValue:t.value.equalCombo,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.equalCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",$e,[o(C,{type:"number",modelValue:t.value.disadvantageCombo,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.disadvantageCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])])]),s("tr",null,[s("th",Ue,m(a.$t("attack.numberOfSingleHit")),1),s("td",we,[o(C,{type:"number",modelValue:t.value.advantageSingle,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.advantageSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",Ne,[o(C,{type:"number",modelValue:t.value.equalSingle,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.equalSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),s("td",Pe,[o(C,{type:"number",modelValue:t.value.disadvantageSingle,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.disadvantageSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])])])])]),_:1})])]),_:1})]),_:1}),o(oe,{data:J.value,scores:A.value,score:j.value},null,8,["data","scores","score"])]),_:1})]),_:1})]),_:1}))}}),Be=ve(xe,[["__scopeId","data-v-0d95df9a"]]);export{Be as default};
