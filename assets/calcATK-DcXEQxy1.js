import{C as ae,r as le,u as te,V as I,D as se}from"./simulatorStore-DPYzAbs5.js";import{d as oe,i as ne,r as S,e as d,X as ue,H as de,c as ie,w as n,g as s,a as o,t as m,m as ce,V as p,b as D,b7 as re,o as me,_ as ve}from"./index-BpOh7V4n.js";import{V as v,a as V}from"./VRow-VaSeiI_7.js";import{V as fe}from"./VContainer-D8QndJcu.js";const ge={class:"field-label"},be={class:"field-label"},pe={class:"field-label"},Ce={class:"field-label"},Se={class:"field-label"},Ve={class:"mdi mdi-help-circle-outline"},ke={class:"table-wrapper"},_e={class:"pa-0"},he={class:"pa-0"},Ae={class:"pa-0"},ye={class:"text-nowrap wide-cell pa-0"},qe={class:"mdi mdi-help-circle-outline"},De={class:"pa-0"},Fe={class:"pa-0"},$e={class:"pa-0"},Ue={class:"text-nowrap pa-0"},we={class:"pa-0"},Ne={class:"pa-0"},Pe={class:"pa-0"},xe=oe({__name:"calcATK",props:{selectedAttribute:{}},setup(K){ae.register(...le);const{t:g}=ne(),C=te(),F=K,$=S(!1),k=S(0),_=S(0),h=S(0),A=S(0),r=S(1.5),z=[{text:"Easy",value:.8},{text:"Normal",value:1},{text:"Hard",value:1.2},{text:"Extra",value:1.5}],t=S({advantageCombo:0,equalCombo:0,disadvantageCombo:0,advantageSingle:0,equalSingle:0,disadvantageSingle:0}),U=d(()=>Number(t.value.advantageCombo)+Number(t.value.equalCombo)+Number(t.value.disadvantageCombo)+Number(t.value.advantageSingle)+Number(t.value.equalSingle)+Number(t.value.disadvantageSingle)),w=d(()=>Number((_.value/208).toFixed(0))),N=d(()=>h.value*120),P=d(()=>A.value*180),x=d(()=>t.value.advantageCombo*210),H=d(()=>t.value.equalCombo*180),O=d(()=>t.value.disadvantageCombo*150),T=d(()=>t.value.advantageSingle*150),M=d(()=>t.value.equalSingle*120),E=d(()=>t.value.disadvantageSingle*90),B=d(()=>11036+k.value*.080471),R=d(()=>641.2+k.value*.002048),G=d(()=>B.value-R.value*U.value+w.value+N.value+P.value+x.value+H.value+O.value+T.value+M.value+E.value),X=d(()=>(G.value*r.value).toFixed()),b=["#FAD9C8","#FAF2C8","#E9FAC8","#D0FAC8","#C8FAD9","#C8FAF2","#C8E9FA","#C8D0FA","#D9C8FA","#F2C8FA"],y=d(()=>[{label:g("attack.numberOfActions"),value:Number(((B.value-R.value*U.value)*r.value).toFixed()),color:b[0]},{label:g("attack.numberOfAdvantage2"),value:x.value*r.value,color:b[1]},{label:g("attack.damage"),value:w.value*r.value,color:b[2]},{label:g("attack.nullifingHPRestoration"),value:P.value*r.value,color:b[3]},{label:g("attack.numberOfDisadvantage2"),value:H.value*r.value,color:b[4]},{label:g("attack.buff"),value:N.value*r.value,color:b[5]},{label:g("attack.numberOfAdvantage1"),value:T.value*r.value,color:b[6]},{label:g("attack.numberOfNeutral2"),value:O.value*r.value,color:b[7]},{label:g("attack.numberOfDisadvantage1"),value:M.value*r.value,color:b[8]},{label:g("attack.numberOfNeutral1"),value:E.value*r.value,color:b[9]}].sort((a,e)=>e.value-a.value)),j=d(()=>({labels:y.value.map(a=>a.label),datasets:[{data:y.value.map(a=>a.value),backgroundColor:y.value.map(a=>a.color)}]}));ue(async()=>{await C.waitForDeckStats(),$.value=!0,de(()=>[C.deckCharacters,F.selectedAttribute,C.isDeckStatsReady],()=>{$.value&&C.isDeckStatsReady&&J()},{deep:!0,immediate:!0})});async function J(){if($.value)try{const a=F.selectedAttribute||"対全",e=await C.getSafeDeckDamage(a);_.value=Math.floor(e);const l=L();h.value=l;const i=Q();A.value=Math.min(i,1);const c=W();t.value.advantageCombo=c.advantage.combo,t.value.equalCombo=c.equal.combo,t.value.disadvantageCombo=c.disadvantage.combo,t.value.advantageSingle=c.advantage.single,t.value.equalSingle=c.equal.single,t.value.disadvantageSingle=c.disadvantage.single}catch{_.value=0,h.value=0,A.value=0,t.value.advantageCombo=0,t.value.equalCombo=0,t.value.disadvantageCombo=0,t.value.advantageSingle=0,t.value.equalSingle=0,t.value.disadvantageSingle=0}}function L(){let a=0;const e=["ATKUP","火属性ダメージUP","水属性ダメージUP","木属性ダメージUP","無属性ダメージUP","ダメージUP","クリティカル"];return(C.deckCharacters||[]).forEach(l=>{if(!(!l||!l.name||l.name===""||l.name==="なし")){for(let i=1;i<=3;i++)if(l[`isM${i}Selected`]){const q=(l.etc||"").split(",").map(u=>u.trim()).filter(u=>u.includes(`(M${i})`));for(const u of q)for(const ee of e)if(u.includes(ee)){if(u.includes("被ダメージUP"))continue;if(u.includes("自")||u.includes("味方")){a++;break}}}}}),a}function Q(){for(const a of C.deckCharacters||[])if(!(!a||!a.name||a.name===""||a.name==="なし")){for(let e=1;e<=3;e++)if(a[`isM${e}Selected`]){const c=(a.etc||"").split(",").map(f=>f.trim()).filter(f=>f.includes(`(M${e})`));for(const f of c)if(f.includes("呪い")&&!f.includes("呪い無効"))return 1}}return 0}function W(){const a={advantage:{combo:0,single:0},equal:{combo:0,single:0},disadvantage:{combo:0,single:0}},e=F.selectedAttribute||"対全",l=e.replace("対","");return(C.deckCharacters||[]).forEach(i=>{if(!(!i||!i.name||i.name===""||i.name==="なし")){for(let c=1;c<=3;c++)if(i[`isM${c}Selected`]){const f=i[`magic${c}Attribute`],q=i[`magic${c}Power`];let u;e==="対全"?f==="無"?u="equal":u="advantage":l==="無"?u="equal":Y(f,l)?u="advantage":Z(f,l)?u="disadvantage":u="equal",q==="単発(弱)"||q==="単発(強)"?a[u].single++:a[u].combo++}}}),a}function Y(a,e){return{火:"木",水:"火",木:"水"}[a]===e}function Z(a,e){return{火:"水",水:"木",木:"火"}[a]===e}return(a,e)=>(me(),ie(fe,{class:"pa-2"},{default:n(()=>[s(V,{class:"ma-0"},{default:n(()=>[s(v,{cols:"12",class:"pa-0"},{default:n(()=>[s(V,{align:"center",class:"ma-0"},{default:n(()=>[s(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[o("span",ge,m(a.$t("attack.difficulty")),1)]),_:1}),s(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[s(ce,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),items:z,"item-title":"text","item-value":"value","hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),_:1})]),_:1}),s(V,{align:"center",class:"ma-0"},{default:n(()=>[s(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[o("span",be,m(a.$t("attack.enemyHP")),1)]),_:1}),s(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[s(p,{type:"number",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=l=>k.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),s(V,{align:"center",class:"ma-0"},{default:n(()=>[s(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[o("span",pe,m(a.$t("attack.totalDamageDealt")),1)]),_:1}),s(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[s(p,{type:"number",modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=l=>_.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:k.value},null,8,["modelValue","min"])]),_:1})]),_:1}),s(V,{align:"center",class:"ma-0"},{default:n(()=>[s(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[o("span",Ce,m(a.$t("attack.buff")),1)]),_:1}),s(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[s(p,{type:"number",modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=l=>h.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0},null,8,["modelValue"])]),_:1})]),_:1}),s(V,{align:"center",class:"ma-0"},{default:n(()=>[s(v,{cols:"4",sm:"3",class:"pa-0 pr-1 text-right"},{default:n(()=>[o("span",Se,[D(m(a.$t("attack.nullifingHPRestoration"))+" ",1),o("span",Ve,[s(I,{activator:"parent","open-on-click":""},{default:n(()=>[D(m(a.$t("attack.maxNum")),1)]),_:1})])])]),_:1}),s(v,{cols:"8",sm:"9",class:"pa-0"},{default:n(()=>[s(p,{type:"number",modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=l=>A.value=l),class:"mt-0 pt-0","hide-details":"auto",dense:"",solo:"",min:0,max:1},null,8,["modelValue"])]),_:1})]),_:1}),s(V,{class:"ma-0"},{default:n(()=>[s(v,{class:"pa-0"},{default:n(()=>[o("div",ke,[s(re,null,{default:n(()=>[o("thead",null,[o("tr",null,[e[11]||(e[11]=o("th",null,null,-1)),o("th",_e,m(a.$t("attack.advantage")),1),o("th",he,m(a.$t("attack.neutral")),1),o("th",Ae,m(a.$t("attack.disadvantage")),1)])]),o("tbody",null,[o("tr",null,[o("th",ye,[D(m(a.$t("attack.numberOfMultihit"))+" ",1),o("span",qe,[s(I,{style:{"white-space":"nowrap"},activator:"parent","open-on-click":""},{default:n(()=>[D(m(a.$t("attack.attackDetail")),1)]),_:1})])]),o("td",De,[s(p,{type:"number",modelValue:t.value.advantageCombo,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.advantageCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),o("td",Fe,[s(p,{type:"number",modelValue:t.value.equalCombo,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.equalCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),o("td",$e,[s(p,{type:"number",modelValue:t.value.disadvantageCombo,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.disadvantageCombo=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])])]),o("tr",null,[o("th",Ue,m(a.$t("attack.numberOfSingleHit")),1),o("td",we,[s(p,{type:"number",modelValue:t.value.advantageSingle,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.advantageSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),o("td",Ne,[s(p,{type:"number",modelValue:t.value.equalSingle,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.equalSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])]),o("td",Pe,[s(p,{type:"number",modelValue:t.value.disadvantageSingle,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.disadvantageSingle=l),"hide-details":"",dense:"",solo:""},null,8,["modelValue"])])])])]),_:1})])]),_:1})]),_:1}),s(se,{data:j.value,scores:y.value,score:X.value},null,8,["data","scores","score"])]),_:1})]),_:1})]),_:1}))}}),Ee=ve(xe,[["__scopeId","data-v-41e79a2b"]]);export{Ee as default};
