import{an as Re,v as re,ah as m}from"./index-2c9e4a26.js";import{c as Se,u as we,_ as Oe}from"./characters-f01707c2.js";const Me=()=>Se.filter(e=>e.rare==="SSR").map(e=>e.name),Ce=Re("searchSettings",{state:()=>({minEHP:3e4,minHP:3e4,minHPBuddy:0,minIncreasedHPBuddy:0,minEvasion:0,minDuo:0,minBuff:0,minDebuff:0,minCosmic:0,minFire:0,minWater:0,minFlora:0,minReferenceDamage:0,minReferenceAdvantageDamage:0,minReferenceVsHiDamage:0,minReferenceVsMizuDamage:0,minReferenceVsKiDamage:0,maxResult:10,attackNum:10,sortOptions:[{prop:"settingModal.effectiveHP",order:"settingModal.desc"}],mustCharacters:[],convertedMustCharacters:[],allowSameCharacter:!1,selectedSupportCharacters:Me()}),actions:{updateSearchSettings(e){Object.assign(this,e)}}}),Ke=Re("searchResult",{state:()=>({totalResults:0,nowResults:0,results:[],isSearching:!1,errorMessage:""})}),Ue=Ce(),{minEHP:Fe,minHP:qe,minDebuff:ze,minBuff:je,minHPBuddy:We,minIncreasedHPBuddy:Ne,minEvasion:$e,minDuo:Je,minCosmic:xe,minFire:Ge,minWater:Ze,minFlora:Qe,minReferenceDamage:Xe,minReferenceAdvantageDamage:Ye,minReferenceVsHiDamage:et,minReferenceVsKiDamage:tt,minReferenceVsMizuDamage:at,maxResult:_e,sortOptions:it,convertedMustCharacters:st,allowSameCharacter:rt,attackNum:q,selectedSupportCharacters:ot}=re(Ue),nt=we(),{characters:Q}=re(nt),mt=Ke(),{totalResults:$,nowResults:ve,results:P,isSearching:De,errorMessage:J}=re(mt);function Dt(e){(e.key==="e"||e.key==="+")&&e.preventDefault()}function ct(e){return[e("comments.HP"),e("comments.effectiveHP"),e("comments.HPBuddy"),e("comments.increasedHPBuddy"),e("comments.noHPBuddy"),e("comments.buddy"),e("comments.evasion"),e("comments.duo"),e("comments.buff"),e("comments.debuff"),e("comments.maxCosmic"),e("comments.maxFire"),e("comments.maxWater"),e("comments.maxFlora"),e("comments.neutralDamage"),e("comments.advantageDamage"),e("comments.damageAgainstFire"),e("comments.damageAgainstWater"),e("comments.damageAgainstFlora")]}function Pt(e){return[e("comments.riddle"),e("comments.ace"),e("comments.deuce"),e("comments.cater"),e("comments.trey"),e("comments.leona"),e("comments.jack"),e("comments.ruggie"),e("comments.azul"),e("comments.jade"),e("comments.floyd"),e("comments.kalim"),e("comments.jamil"),e("comments.vil"),e("comments.epel"),e("comments.rook"),e("comments.idia"),e("comments.ortho"),e("comments.malleus"),e("comments.silver"),e("comments.sebek"),e("comments.lilia"),e("comments.grim"),e("comments.lolo"),e("comments.crowley"),e("comments.crewel"),e("comments.fellow"),e("comments.train")]}const lt=["hp","ehp","hpBuddy","increasedHpBuddy","noHpBuddy","buddy","evasion","duo","buff","debuff","maxCosmic","maxFire","maxWater","maxFlora","referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"],Rt={Riddle:"リドル",Ace:"エース",Deuce:"デュース",Cater:"ケイト",Trey:"トレイ",Leona:"レオナ",Jack:"ジャック",Ruggie:"ラギー",Azul:"アズール",Jade:"ジェイド",Floyd:"フロイド",Kalim:"カリム",Jamil:"ジャミル",Vil:"ヴィル",Epel:"エペル",Rook:"ルーク",Idia:"イデア",Ortho:"オルト",Malleus:"マレウス",Silver:"シルバー",Sebek:"セベク",Lilia:"リリア",Grim:"グリム",Lolo:"ロロ",Crowley:"クロウリー",Crewel:"クルーウェル",Fellow:"フェロー",Train:"トレイン"},x={"HPUP(小)":{hp:.2,atk:0,heal:0,conHeal:0},"HP&ATKUP(小)":{hp:.2,atk:.2,heal:0,conHeal:0},"HPUP(中)":{hp:.3,atk:0,heal:0,conHeal:0},"HP&ATKUP(中)":{hp:.3,atk:.35,heal:0,conHeal:0},"ATKUP(小)":{hp:0,atk:.2,heal:0,conHeal:0},"ATKUP(中)":{hp:0,atk:.35,heal:0,conHeal:0},"回復(小)":{hp:0,atk:0,heal:1.1,conHeal:0},"回復&継続回復(小)":{hp:0,atk:0,heal:1.1,conHeal:.15*3},"回復(中)":{hp:0,atk:0,heal:1.7,conHeal:0},"回復&継続回復(中)":{hp:0,atk:0,heal:1.7,conHeal:.25*3},"継続回復(小)":{hp:0,atk:0,heal:0,conHeal:.15*3},"継続回復(中)":{hp:0,atk:0,heal:0,conHeal:.25*3}};function X(e){var i;return((i=x[e])==null?void 0:i.hp)||0}function Y(e){var i;return((i=x[e])==null?void 0:i.atk)||0}function ee(e){var i;return((i=x[e])==null?void 0:i.heal)||0}function te(e){var i;return((i=x[e])==null?void 0:i.conHeal)||0}const ut={"ATKUP(極小)":1.1,"ATKUP(小)":1.2,"ATKUP(中)":1.35,"ATKUP(大)":1.5,"ATKUP(極大)":1.8},ft={"ダメUP(極小)":.025,"ダメUP(小)":.05,"ダメUP(中)":.0875,"ダメUP(大)":.125,"ダメUP(極大)":.1875,"属性ダメUP(極小)":.03,"属性ダメUP(小)":.06,"属性ダメUP(中)":.1005,"属性ダメUP(大)":.15,"属性ダメUP(極大)":.27},ae={};function gt(e,i,u,n){const c=`${e},${i},${u},${n}`;if(c in ae)return ae[c];let d=i.includes("弱")?.75:1;d*=u==="無"?1.1:1,d+=ft[e]||0;let v=1;(i=="連撃(弱)"||i=="連撃(強)")&&(v=1.8),(i=="デュオ魔法"||i=="3連撃(弱)")&&(v=2.4);const A=n*d*v;return ae[c]=A,A}function ie(e,i,u,n,c){return n=(ut[e]||1)*n+n*c,gt(e,i,u=="無"?"無":"無以外",n)}function z(e,i,u){const n=[e,i,u];return n.sort((c,d)=>d-c),[n[0],n[1]]}function dt(e){const i=new Set;for(const t of e)i.add(t.chara);if(!Array.from(st.value).every(t=>i.has(t)))return;let n=0,c=0,d=0,v=0,A=0,j=0,E=0,H=0,T=0,L=0,O=0,f=0,M=0,a=99999;const o=[],s=[],l=[],g=[],_=[];let D=0,C=0,K=0,U=0,F=0;const k={},G={},R={},oe=[];let ne="";const b=[],me=[],ce=[],le=[],ue=[],fe=[],ge=[];e.forEach((t,r)=>{k[r]=!1,G[r]=!1,R[r]=!1});function W(t,r){let h=0;return t.magic1atr==r&&(h+=1),t.magic2atr==r&&(h+=1),t.magic3atr==r&&t.hasM3&&(h+=1),Math.min(h,2)}if(e.forEach((t,r)=>{oe.push(t.imgUrl),ne+="&name"+(r+1)+"="+t.name,n+=t.calcBaseHP,E+=t.buff_count,H+=t.debuff_count,L+=W(t,"無"),O+=W(t,"火"),f+=W(t,"水"),M+=W(t,"木");let h=!1,V=0,N=0;if(i.has(t.buddy1c)){A+=1;const p=X(t.buddy1s);V+=Y(t.buddy1s),p!=0&&(v+=1,h=!0,n+=t.calcBaseHP*p,N+=t.calcBaseHP*p)}if(i.has(t.buddy2c)){A+=1;const p=X(t.buddy2s);V+=Y(t.buddy2s),p!=0&&(v+=1,h=!0,n+=t.calcBaseHP*p,N+=t.calcBaseHP*p)}if(i.has(t.buddy3c)){A+=1;const p=X(t.buddy3s);V+=Y(t.buddy3s),p!=0&&(v+=1,h=!0,n+=t.calcBaseHP*p,N+=t.calcBaseHP*p)}a=Math.min(a,N);const de=(ee(t.magic1heal)+ee(t.magic2heal)+(t.hasM3?ee(t.magic3heal):0))*t.calcBaseATK,pe=(te(t.magic1heal)+te(t.magic2heal)+(t.hasM3?te(t.magic3heal):0))*t.calcBaseHP;c+=de+pe,me.push(de+pe),d+=t.evasion,h||(j+=1);let Z=t.magic2pow;if(R[r])Z="デュオ魔法",T+=1;else{if(!R[r]){for(const[p,w]of e.entries())if(w.duo==t.chara&&t.duo==w.chara&&!R[r]&&!R[p]){R[r]=!0,R[p]=!0,k[r]=!0,k[p]=!0;break}if(!k[r]){for(const[p,w]of e.entries())if(t.duo==w.chara&&!R[r]&&!k[r]&&!G[p]){R[r]=!0,k[r]=!0,G[p]=!0;break}}if(!k[r]){for(const[p,w]of e.entries())if(t.duo==w.chara&&!R[r]&&!k[r]&&!k[p]){R[r]=!0,k[r]=!0,k[p]=!0;break}}}R[r]&&(Z="デュオ魔法",T+=1)}const B=ie(t.magic1buf,t.magic1pow,t.magic1atr,t.calcBaseATK,V),I=ie(t.magic2buf,Z,t.magic2atr,t.calcBaseATK,V),S=t.hasM3?ie(t.magic3buf,t.magic3pow,t.magic3atr,t.calcBaseATK,V):0,ke=t.magic1atr=="無"?B:B*1.5,Ae=t.magic2atr=="無"?I:I*1.5,Ee=t.magic3atr=="無"?S:S*1.5,he=y(t.magic1atr,"火",B),ye=y(t.magic2atr,"火",I),He=y(t.magic3atr,"火",S),Te=y(t.magic1atr,"水",B),Le=y(t.magic2atr,"水",I),be=y(t.magic3atr,"水",S),Ve=y(t.magic1atr,"木",B),Be=y(t.magic2atr,"木",I),Ie=y(t.magic3atr,"木",S);o.push(...z(B,I,S)),s.push(...z(ke,Ae,Ee)),l.push(...z(he,ye,He)),g.push(...z(Te,Le,be)),_.push(...z(Ve,Be,Ie)),ce.push(o.at(-1)+o.at(-2)),le.push(s.at(-1)+s.at(-2)),ue.push(l.at(-1)+l.at(-2)),fe.push(g.at(-1)+g.at(-2)),ge.push(_.at(-1)+_.at(-2))}),D=o.sort((t,r)=>r-t).slice(0,q.value).reduce((t,r)=>t+r,0),C=s.sort((t,r)=>r-t).slice(0,q.value).reduce((t,r)=>t+r,0),K=l.sort((t,r)=>r-t).slice(0,q.value).reduce((t,r)=>t+r,0),U=g.sort((t,r)=>r-t).slice(0,q.value).reduce((t,r)=>t+r,0),F=_.sort((t,r)=>r-t).slice(0,q.value).reduce((t,r)=>t+r,0),!(n<qe.value)&&!(n+c<Fe.value)&&!(v<We.value)&&!(a<Ne.value)&&!(d<$e.value)&&!(T<Je.value)&&!(E<je.value)&&!(H<ze.value)&&!(L<xe.value)&&!(O<Ge.value)&&!(f<Ze.value)&&!(M<Qe.value)&&!(D<Xe.value)&&!(C<Ye.value)&&!(K<et.value)&&!(U<at.value)&&!(F<tt.value))return D=Math.floor(D),C=Math.floor(C),K=Math.floor(K),U=Math.floor(U),F=Math.floor(F),a=Math.floor(a),b.push(me),b.push(ce),b.push(le),b.push(ue),b.push(fe),b.push(ge),[n,n+c,d,v,a,A,j,T,E,H,L,O,f,M,D,C,K,U,F,...oe,ne,b]}const pt={水:{火:1.5,木:.5},木:{水:1.5,火:.5},火:{木:1.5,水:.5}};function y(e,i,u){var c;const n=(c=pt[e])==null?void 0:c[i];return n?u*n:u}function Pe(e){return function(i,u){for(let n=0;n<e.length;n++){const{key:c,order:d}=e[n];if(!Object.prototype.hasOwnProperty.call(i,c)||!Object.prototype.hasOwnProperty.call(u,c))continue;let v=0;if(i[c]<u[c]?v=-1:i[c]>u[c]&&(v=1),v!==0)return d==="降順"?v*-1:v}return 0}}function se(e){return e<=0?1:e*se(e-1)}async function kt(e){for(const a of Q.value)if(a.required&&a.level==0){J.value=e("error.requiredCharacter");return}const i=Q.value.filter(a=>a.level>0).map(a=>({...a,calcBaseHP:0,calcBaseATK:0})),u=Q.value.filter(a=>a.rare=="SSR"&&ot.value.includes(a.name)).map(a=>({...a,calcBaseHP:0,calcBaseATK:0}));i.forEach(a=>{let o=110;a.rare=="SR"?o=90:a.rare=="R"&&(o=70);const s=a.base_hp*.2,l=a.base_atk*.2,g=(a.hp-2*s-a.base_hp)/(o-1),_=(a.atk-2*l-a.base_atk)/(o-1),D=o-a.level;a.calcBaseHP=a.hp-g*D,a.calcBaseATK=a.atk-_*D}),u.forEach(a=>{a.calcBaseHP=a.hp,a.calcBaseATK=a.atk});const n=i.length;if(n<5){J.value=e("error.fewCharacter");return}ve.value=0;const c=ct(e),d=[];for(const a of it.value)for(let o=0;o<c.length;o++)if(c[o]==a.prop){let s="降順";switch(a.order){case"ASC":s="昇順";break;case"DESC":s="降順";break;case"昇順":case"降順":s=a.order;break;default:continue}d.push({key:lt[o],order:s})}if(d.length===0){J.value=e("search.noSettingOptions");return}const v=d[0].order==="昇順";async function A(){P.value.sort(Pe(d));const a=P.value.slice(0,_e.value);P.value=[...a],P.value.length>0&&(H=P.value[P.value.length-1][d[0].key]),await new Promise(requestAnimationFrame)}const j=new Set(["referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"]);d[0].key in j?i.sort((a,o)=>a.required&&!o.required?-1:!a.required&&o.required?1:o.calcBaseATK-a.calcBaseATK):i.sort((a,o)=>a.required&&!o.required?-1:!a.required&&o.required?1:o.calcBaseHP-a.calcBaseHP);const E=i.filter(a=>a.required).length;if(E>5){J.value="必須設定されたキャラが多すぎます";return}P.value=[];let H=d[0].order==="昇順"?1/0:-1/0;const T=async a=>new Promise(o=>{const s=dt(a);if(s){const l={hp:Math.round(s[0]),ehp:Math.round(s[1]),evasion:s[2],hpBuddy:s[3],increasedHpBuddy:s[4],buddy:s[5],noHpBuddy:s[6],duo:s[7],buff:s[8],debuff:s[9],maxCosmic:s[10],maxFire:s[11],maxWater:s[12],maxFlora:s[13],referenceDamage:s[14],referenceAdvantageDamage:s[15],referenceVsHiDamage:s[16],referenceVsMizuDamage:s[17],referenceVsKiDamage:s[18],chara1:s[19],chara2:s[20],chara3:s[21],chara4:s[22],chara5:s[23],simuURL:s[24],detailList:s[25]},g=l[d[0].key];(v&&g<=H||!v&&g>=H)&&P.value.push(l)}ve.value+=1,o()}),L=async(a,o,s,l,g)=>{const _=[i[a],i[o],i[s],i[l],i[g]];await T(_)},O=async(a,o,s,l,g)=>{const _=[i[a],i[o],i[s],i[l],u[g]];await T(_)},f=new Array(5).fill(n);for(let a=0;a<E;a++)f[a]=a+1;if(rt.value){let a=Date.now();const o=f[0]*(f[1]-1)*(f[2]-2)*(f[3]-3);if($.value=o*u.length/se(4-E),E==5){$.value=1,await L(0,1,2,3,4),await new Promise(requestAnimationFrame);return}for(let s=0;s<f[0];s++)for(let l=s+1;l<f[1];l++)for(let g=l+1;g<f[2];g++){if(!De.value)return;for(let _=g+1;_<f[3];_++)for(let D=0;D<u.length;D++)await O(s,l,g,_,D),Date.now()-a>2e3&&(a=Date.now(),await A())}}else{const a=f[0]*(f[1]-1)*(f[2]-2)*(f[3]-3);if($.value=a*(f[4]-4)/se(5-E),E==5){$.value=1,await L(0,1,2,3,4),await new Promise(requestAnimationFrame);return}let o=Date.now();for(let s=0;s<f[0];s++)for(let l=s+1;l<f[1];l++)for(let g=l+1;g<f[2];g++){if(!De.value)return;for(let _=g+1;_<f[3];_++)for(let D=_+1;D<f[4];D++)await L(s,l,g,_,D),Date.now()-o>2e3&&(o=Date.now(),await A())}}P.value.sort(Pe(d));const M=P.value.slice(0,_e.value);P.value=[...M],P.value.length>0&&(H=P.value[P.value.length-1][d[0].key])}async function At(e){const i={};return await Promise.all(e.map(u=>Oe(Object.assign({"../assets/img/icon/ace.png":()=>m(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>m(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>m(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>m(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>m(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>m(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>m(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>m(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>m(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>m(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>m(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>m(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>m(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>m(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>m(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>m(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>m(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>m(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>m(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>m(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>m(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>m(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>m(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>m(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>m(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>m(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>m(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>m(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>m(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>m(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>m(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>m(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${u.name_en}.png`).then(n=>{i[u.name_en]=n.default}).catch(()=>{i[u.name_en]=""}))),i}export{kt as a,Ce as b,Dt as c,Pt as d,Rt as e,At as f,ct as g,Ke as u};
