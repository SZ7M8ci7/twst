import{u as Ce}from"./characters-2b98dc93.js";import{as as De,y as ae}from"./index-2c33373f.js";const Ke=De("searchSettings",{state:()=>({minEHP:3e4,minHP:3e4,minHPBuddy:0,minEvasion:0,minDuo:0,minBuff:0,minDebuff:0,minCosmic:0,minFire:0,minWater:0,minFlora:0,minReferenceDamage:0,minReferenceAdvantageDamage:0,minReferenceVsHiDamage:0,minReferenceVsMizuDamage:0,minReferenceVsKiDamage:0,maxResult:10,attackNum:10,sortOptions:[{prop:"HP",order:"降順"}],mustCharacters:[],convertedMustCharacters:[],allowSameCharacter:!0}),actions:{updateSearchSettings(a){Object.assign(this,a)}}}),Te=De("searchResult",{state:()=>({totalResults:0,nowResults:0,results:[],isSearching:!1,errorMessage:""})}),Le=Ke(),{minEHP:Ue,minHP:Ve,minDebuff:Fe,minBuff:qe,minHPBuddy:ze,minEvasion:Ee,minDuo:je,minCosmic:Oe,minFire:Ne,minWater:We,minFlora:_e,minReferenceDamage:Ie,minReferenceAdvantageDamage:$e,minReferenceVsHiDamage:Je,minReferenceVsKiDamage:xe,minReferenceVsMizuDamage:Ge,maxResult:fe,sortOptions:Ze,convertedMustCharacters:Qe,allowSameCharacter:Xe,attackNum:j}=ae(Le),Ye=Ce(),{characters:de}=ae(Ye),ea=Te(),{totalResults:W,nowResults:ge,results:k,isSearching:ve,errorMessage:x}=ae(ea);function ma(a){(a.key==="e"||a.key==="+")&&a.preventDefault()}function aa(a){return[a("comments.HP"),a("comments.effectiveHP"),a("comments.HPBuddy"),a("comments.noHPBuddy"),a("comments.buddy"),a("comments.evasion"),a("comments.duo"),a("comments.buff"),a("comments.debuff"),a("comments.maxCosmic"),a("comments.maxFire"),a("comments.maxWater"),a("comments.maxFlora"),a("comments.neutralDamage"),a("comments.advantageDamage"),a("comments.damageAgainstFire"),a("comments.damageAgainstWater"),a("comments.damageAgainstFlora")]}function ua(a){return[a("comments.riddle"),a("comments.ace"),a("comments.deuce"),a("comments.cater"),a("comments.trey"),a("comments.leona"),a("comments.jack"),a("comments.ruggie"),a("comments.azul"),a("comments.jade"),a("comments.floyd"),a("comments.kalim"),a("comments.jamil"),a("comments.vil"),a("comments.epel"),a("comments.rook"),a("comments.idia"),a("comments.ortho"),a("comments.malleus"),a("comments.silver"),a("comments.sebek"),a("comments.lilia"),a("comments.grim"),a("comments.lolo"),a("comments.crowley"),a("comments.crewel"),a("comments.fellow")]}const ta=["hp","ehp","hpBuudy","noHpBuddy","buddy","evasion","duo","buff","debuff","maxCosmic","maxFire","maxWater","maxFlora","referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"],fa={Riddle:"リドル",Ace:"エース",Deuce:"デュース",Cater:"ケイト",Trey:"トレイ",Leona:"レオナ",Jack:"ジャック",Ruggie:"ラギー",Azul:"アズール",Jade:"ジェイド",Floyd:"フロイド",Kalim:"カリム",Jamil:"ジャミル",Vil:"ヴィル",Epel:"エペル",Rook:"ルーク",Idia:"イデア",Ortho:"オルト",Malleus:"マレウス",Silver:"シルバー",Sebek:"セベク",Lilia:"リリア",Grim:"グリム",Lolo:"ロロ",Crowley:"クロウリー",Crewel:"クルーウェル",Fellow:"フェロー"},I={"HPUP(小)":{hp:.2,atk:0,heal:0,conHeal:0},"HP&ATKUP(小)":{hp:.2,atk:.2,heal:0,conHeal:0},"HPUP(中)":{hp:.3,atk:0,heal:0,conHeal:0},"HP&ATKUP(中)":{hp:.3,atk:.35,heal:0,conHeal:0},"ATKUP(小)":{hp:0,atk:.2,heal:0,conHeal:0},"ATKUP(中)":{hp:0,atk:.35,heal:0,conHeal:0},"回復(小)":{hp:0,atk:0,heal:1.1,conHeal:0},"回復&継続回復(小)":{hp:0,atk:0,heal:1.1,conHeal:.15*3},"回復(中)":{hp:0,atk:0,heal:1.7,conHeal:0},"回復&継続回復(中)":{hp:0,atk:0,heal:1.7,conHeal:.25*3},"継続回復(小)":{hp:0,atk:0,heal:0,conHeal:.15*3},"継続回復(中)":{hp:0,atk:0,heal:0,conHeal:.25*3}};function G(a){var s;return((s=I[a])==null?void 0:s.hp)||0}function Z(a){var s;return((s=I[a])==null?void 0:s.atk)||0}function Q(a){var s;return((s=I[a])==null?void 0:s.heal)||0}function X(a){var s;return((s=I[a])==null?void 0:s.conHeal)||0}const na={"ATKUP(極小)":1.1,"ATKUP(小)":1.2,"ATKUP(中)":1.35,"ATKUP(大)":1.5,"ATKUP(極大)":1.8},sa={"ダメUP(極小)":.025,"ダメUP(小)":.05,"ダメUP(中)":.0875,"ダメUP(大)":.125,"ダメUP(極大)":.1875,"属性ダメUP(極小)":.03,"属性ダメUP(小)":.06,"属性ダメUP(中)":.1005,"属性ダメUP(大)":.15,"属性ダメUP(極大)":.27},Y={};function oa(a,s,p,i){const o=`${a},${s},${p},${i}`;if(o in Y)return Y[o];let h=s.includes("弱")?.75:1;h*=p==="無"?1.1:1,h+=sa[a]||0;let u=1;s.includes("連撃")?u=1.8:s.includes("デュオ")&&(u=2.4);const P=i*h*u;return Y[o]=P,P}function ee(a,s,p,i,o){return i=(na[a]||1)*i+i*o,oa(a,s,p=="無"?"無":"無以外",i)}function O(a,s,p){const i=[a,s,p];return i.sort((o,h)=>h-o),[i[0],i[1]]}function ra(a){const s=new Set;for(const e of a)s.add(e.chara);if(!Array.from(Qe.value).every(e=>s.has(e)))return;let i=0,o=0,h=0,u=0,P=0,R=0,S=0,b=0,l=0,F=0,t=0,c=0,m=0;const f=[],d=[],g=[],D=[],r=[];let w=0,B=0,q=0,z=0,E=0;const H={},$={},y={},te=[];let ne="";const C=[],se=[],oe=[],re=[],ie=[],ce=[],le=[];a.sort((e,n)=>n.calcBaseATK-e.calcBaseATK),a.forEach((e,n)=>{H[n]=!1,$[n]=!1,y[n]=!1});function N(e,n){let A=0;return e.magic1atr==n&&(A+=1),e.magic2atr==n&&(A+=1),e.magic3atr==n&&e.hasM3&&(A+=1),Math.min(A,2)}if(a.forEach((e,n)=>{te.push(e.imgUrl),ne+="&name"+(n+1)+"="+e.name,i+=e.calcBaseHP,S+=e.buff_count,b+=e.debuff_count,F+=N(e,"無"),t+=N(e,"火"),c+=N(e,"水"),m+=N(e,"木");let A=!1,K=0;if(s.has(e.buddy1c)){P+=1;const v=G(e.buddy1s);K+=Z(e.buddy1s),v!=0&&(u+=1,A=!0,i+=e.calcBaseHP*v)}if(s.has(e.buddy2c)){P+=1;const v=G(e.buddy2s);K+=Z(e.buddy2s),v!=0&&(u+=1,A=!0,i+=e.calcBaseHP*v)}if(s.has(e.buddy3c)){P+=1;const v=G(e.buddy3s);K+=Z(e.buddy3s),v!=0&&(u+=1,A=!0,i+=e.calcBaseHP*v)}const me=(Q(e.magic1heal)+Q(e.magic2heal)+(e.hasM3?Q(e.magic3heal):0))*e.calcBaseATK,ue=(X(e.magic1heal)+X(e.magic2heal)+(e.hasM3?X(e.magic3heal):0))*e.calcBaseHP;o+=me+ue,se.push(me+ue),h+=e.evasion,A||(R+=1);let J=e.magic2pow;if(y[n])J="デュオ",l+=1;else{if(!y[n]){for(const[v,V]of a.entries())if(V.duo==e.chara&&e.duo==V.chara&&!y[n]&&!y[v]){y[n]=!0,y[v]=!0,H[n]=!0,H[v]=!0;break}if(!H[n]){for(const[v,V]of a.entries())if(e.duo==V.chara&&!y[n]&&!H[n]&&!$[v]){y[n]=!0,H[n]=!0,$[v]=!0;break}}if(!H[n]){for(const[v,V]of a.entries())if(e.duo==V.chara&&!y[n]&&!H[n]&&!H[v]){y[n]=!0,H[n]=!0,H[v]=!0;break}}}y[n]&&(J="デュオ",l+=1)}const T=ee(e.magic1buf,e.magic1pow,e.magic1atr,e.calcBaseATK,K),L=ee(e.magic2buf,J,e.magic2atr,e.calcBaseATK,K),U=e.hasM3?ee(e.magic3buf,e.magic3pow,e.magic3atr,e.calcBaseATK,K):0,ke=e.magic1atr=="無"?T:T*1.5,he=e.magic2atr=="無"?L:L*1.5,ye=e.magic3atr=="無"?U:U*1.5,He=M(e.magic1atr,"火",T),Re=M(e.magic2atr,"火",L),Pe=M(e.magic3atr,"火",U),be=M(e.magic1atr,"水",T),we=M(e.magic2atr,"水",L),Ae=M(e.magic3atr,"水",U),Me=M(e.magic1atr,"木",T),Se=M(e.magic2atr,"木",L),Be=M(e.magic3atr,"木",U);f.push(...O(T,L,U)),d.push(...O(ke,he,ye)),g.push(...O(He,Re,Pe)),D.push(...O(be,we,Ae)),r.push(...O(Me,Se,Be)),oe.push(f.at(-1)+f.at(-2)),re.push(d.at(-1)+d.at(-2)),ie.push(g.at(-1)+g.at(-2)),ce.push(D.at(-1)+D.at(-2)),le.push(r.at(-1)+r.at(-2))}),w=f.sort((e,n)=>n-e).slice(0,j.value).reduce((e,n)=>e+n,0),B=d.sort((e,n)=>n-e).slice(0,j.value).reduce((e,n)=>e+n,0),q=g.sort((e,n)=>n-e).slice(0,j.value).reduce((e,n)=>e+n,0),z=D.sort((e,n)=>n-e).slice(0,j.value).reduce((e,n)=>e+n,0),E=r.sort((e,n)=>n-e).slice(0,j.value).reduce((e,n)=>e+n,0),!(i<Ve.value)&&!(i+o<Ue.value)&&!(u<ze.value)&&!(h<Ee.value)&&!(l<je.value)&&!(S<qe.value)&&!(b<Fe.value)&&!(F<Oe.value)&&!(t<Ne.value)&&!(c<We.value)&&!(m<_e.value)&&!(w<Ie.value)&&!(B<$e.value)&&!(q<Je.value)&&!(z<Ge.value)&&!(E<xe.value))return w=Math.floor(w),B=Math.floor(B),q=Math.floor(q),z=Math.floor(z),E=Math.floor(E),C.push(se),C.push(oe),C.push(re),C.push(ie),C.push(ce),C.push(le),[i,i+o,h,u,P,R,l,S,b,F,t,c,m,w,B,q,z,E,...te,ne,C]}const ia={水:{火:1.5,木:.5},木:{水:1.5,火:.5},火:{木:1.5,水:.5}};function M(a,s,p){var o;const i=(o=ia[a])==null?void 0:o[s];return i?p*i:p}function pe(a){return function(s,p){for(let i=0;i<a.length;i++){const{key:o,order:h}=a[i];if(!Object.prototype.hasOwnProperty.call(s,o)||!Object.prototype.hasOwnProperty.call(p,o))continue;let u=0;if(s[o]<p[o]?u=-1:s[o]>p[o]&&(u=1),u!==0)return h==="降順"?u*-1:u}return 0}}function _(a){return a<=0?1:a*_(a-1)}async function da(a){for(const t of de.value)if(t.required&&t.level==0){x.value=a("error.requiredCharacter");return}const s=de.value.filter(t=>t.level>0),p=s.length;if(p<5){x.value=a("error.fewCharacter");return}ge.value=0;const i=aa(a),o=[];for(const t of Ze.value)for(let c=0;c<i.length;c++)if(i[c]==t.prop){let m="降順";switch(t.order){case"ASC":m="昇順";break;case"DESC":m="降順";break;case"昇順":case"降順":m=t.order;break;default:continue}o.push({key:ta[c],order:m})}const h=o[0].order==="昇順";async function u(){k.value.sort(pe(o));const t=k.value.slice(0,fe.value);k.value=[...t],k.value.length>0&&(S=k.value[k.value.length-1][o[0].key]),await new Promise(requestAnimationFrame)}const P=new Set(["referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"]);o[0].key in P?s.sort((t,c)=>t.required&&!c.required?-1:!t.required&&c.required?1:c.atk-t.atk):s.sort((t,c)=>t.required&&!c.required?-1:!t.required&&c.required?1:c.hp-t.hp);const R=s.filter(t=>t.required).length;if(R>5){x.value="必須設定されたキャラが多すぎます";return}k.value=[],s.forEach(t=>{let c=110;t.rare=="SR"?c=90:t.rare=="R"&&(c=70);const m=t.level/c;t.calcBaseHP=(t.hp-t.base_hp)*m+t.base_hp,t.calcBaseATK=(t.atk-t.base_atk)*m+t.base_atk});let S=o[0].order==="昇順"?1/0:-1/0;const b=async(t,c,m,f,d)=>new Promise(g=>{const D=[s[t],s[c],s[m],s[f],s[d]],r=ra(D);if(r){const w={hp:Math.round(r[0]),ehp:Math.round(r[1]),evasion:r[2],hpBuudy:r[3],buddy:r[4],noHpBuddy:r[5],duo:r[6],buff:r[7],debuff:r[8],maxCosmic:r[9],maxFire:r[10],maxWater:r[11],maxFlora:r[12],referenceDamage:r[13],referenceAdvantageDamage:r[14],referenceVsHiDamage:r[15],referenceVsMizuDamage:r[16],referenceVsKiDamage:r[17],chara1:r[18],chara2:r[19],chara3:r[20],chara4:r[21],chara5:r[22],simuURL:r[23],detailList:r[24]},B=w[o[0].key];(h&&B<S||!h&&B>S)&&k.value.push(w)}ge.value+=1,g()}),l=new Array(5).fill(p);for(let t=0;t<R;t++)l[t]=t+1;if(Xe.value){let t=Date.now();const c=l[0]*(l[1]-1)*(l[2]-2)*(l[3]-3);if(W.value=c*(l[4]-4)/_(5-R)+c*4/_(4-R),R==5){W.value=1,await b(0,1,2,3,4),await new Promise(requestAnimationFrame);return}for(let m=0;m<l[0];m++)for(let f=m+1;f<l[1];f++)for(let d=f+1;d<l[2];d++){if(!ve.value)return;for(let g=d+1;g<l[3];g++){for(let D=g+1;D<l[4];D++)await b(m,f,d,g,D),Date.now()-t>2e3&&(t=Date.now(),await u());for(const D of[m,f,d,g])await b(m,f,d,g,D),Date.now()-t>2e3&&(t=Date.now(),await u())}}}else{const t=l[0]*(l[1]-1)*(l[2]-2)*(l[3]-3);if(W.value=t*(l[4]-4)/_(5-R),R==5){W.value=1,await b(0,1,2,3,4),await new Promise(requestAnimationFrame);return}let c=Date.now();for(let m=0;m<l[0];m++)for(let f=m+1;f<l[1];f++)for(let d=f+1;d<l[2];d++){if(!ve.value)return;for(let g=d+1;g<l[3];g++)for(let D=g+1;D<l[4];D++)await b(m,f,d,g,D),Date.now()-c>2e3&&(c=Date.now(),await u())}}k.value.sort(pe(o));const F=k.value.slice(0,fe.value);k.value=[...F],k.value.length>0&&(S=k.value[k.value.length-1][o[0].key])}export{ua as a,Te as b,ma as c,da as d,fa as e,aa as g,Ke as u};
