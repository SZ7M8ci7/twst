import{al as Re,v as se,ah as m}from"./index-945c29b3.js";import{u as Ie,_ as Oe}from"./characters-332a175a.js";const Me=Re("searchSettings",{state:()=>({minEHP:3e4,minHP:3e4,minHPBuddy:0,minIncreasedHPBuddy:0,minEvasion:0,minDuo:0,minBuff:0,minDebuff:0,minCosmic:0,minFire:0,minWater:0,minFlora:0,minReferenceDamage:0,minReferenceAdvantageDamage:0,minReferenceVsHiDamage:0,minReferenceVsMizuDamage:0,minReferenceVsKiDamage:0,maxResult:10,attackNum:10,sortOptions:[{prop:"settingModal.effectiveHP",order:"settingModal.desc"}],mustCharacters:[],convertedMustCharacters:[],allowSameCharacter:!1}),actions:{updateSearchSettings(t){Object.assign(this,t)}}}),Ke=Re("searchResult",{state:()=>({totalResults:0,nowResults:0,results:[],isSearching:!1,errorMessage:""})}),Se=Me(),{minEHP:Ce,minHP:Ue,minDebuff:Fe,minBuff:qe,minHPBuddy:ze,minIncreasedHPBuddy:je,minEvasion:We,minDuo:Ne,minCosmic:$e,minFire:Je,minWater:xe,minFlora:Ge,minReferenceDamage:Ze,minReferenceAdvantageDamage:Qe,minReferenceVsHiDamage:Xe,minReferenceVsKiDamage:Ye,minReferenceVsMizuDamage:et,maxResult:_e,sortOptions:tt,convertedMustCharacters:at,allowSameCharacter:it,attackNum:q}=se(Se),ot=Ie(),{characters:Z}=se(ot),st=Ke(),{totalResults:$,nowResults:ve,results:P,isSearching:De,errorMessage:Q}=se(st);function pt(t){(t.key==="e"||t.key==="+")&&t.preventDefault()}function rt(t){return[t("comments.HP"),t("comments.effectiveHP"),t("comments.HPBuddy"),t("comments.increasedHPBuddy"),t("comments.noHPBuddy"),t("comments.buddy"),t("comments.evasion"),t("comments.duo"),t("comments.buff"),t("comments.debuff"),t("comments.maxCosmic"),t("comments.maxFire"),t("comments.maxWater"),t("comments.maxFlora"),t("comments.neutralDamage"),t("comments.advantageDamage"),t("comments.damageAgainstFire"),t("comments.damageAgainstWater"),t("comments.damageAgainstFlora")]}function _t(t){return[t("comments.riddle"),t("comments.ace"),t("comments.deuce"),t("comments.cater"),t("comments.trey"),t("comments.leona"),t("comments.jack"),t("comments.ruggie"),t("comments.azul"),t("comments.jade"),t("comments.floyd"),t("comments.kalim"),t("comments.jamil"),t("comments.vil"),t("comments.epel"),t("comments.rook"),t("comments.idia"),t("comments.ortho"),t("comments.malleus"),t("comments.silver"),t("comments.sebek"),t("comments.lilia"),t("comments.grim"),t("comments.lolo"),t("comments.crowley"),t("comments.crewel"),t("comments.fellow"),t("comments.train")]}const nt=["hp","ehp","hpBuddy","increasedHpBuddy","noHpBuddy","buddy","evasion","duo","buff","debuff","maxCosmic","maxFire","maxWater","maxFlora","referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"],vt={Riddle:"リドル",Ace:"エース",Deuce:"デュース",Cater:"ケイト",Trey:"トレイ",Leona:"レオナ",Jack:"ジャック",Ruggie:"ラギー",Azul:"アズール",Jade:"ジェイド",Floyd:"フロイド",Kalim:"カリム",Jamil:"ジャミル",Vil:"ヴィル",Epel:"エペル",Rook:"ルーク",Idia:"イデア",Ortho:"オルト",Malleus:"マレウス",Silver:"シルバー",Sebek:"セベク",Lilia:"リリア",Grim:"グリム",Lolo:"ロロ",Crowley:"クロウリー",Crewel:"クルーウェル",Fellow:"フェロー",Train:"トレイン"},J={"HPUP(小)":{hp:.2,atk:0,heal:0,conHeal:0},"HP&ATKUP(小)":{hp:.2,atk:.2,heal:0,conHeal:0},"HPUP(中)":{hp:.3,atk:0,heal:0,conHeal:0},"HP&ATKUP(中)":{hp:.3,atk:.35,heal:0,conHeal:0},"ATKUP(小)":{hp:0,atk:.2,heal:0,conHeal:0},"ATKUP(中)":{hp:0,atk:.35,heal:0,conHeal:0},"回復(小)":{hp:0,atk:0,heal:1.1,conHeal:0},"回復&継続回復(小)":{hp:0,atk:0,heal:1.1,conHeal:.15*3},"回復(中)":{hp:0,atk:0,heal:1.7,conHeal:0},"回復&継続回復(中)":{hp:0,atk:0,heal:1.7,conHeal:.25*3},"継続回復(小)":{hp:0,atk:0,heal:0,conHeal:.15*3},"継続回復(中)":{hp:0,atk:0,heal:0,conHeal:.25*3}};function X(t){var i;return((i=J[t])==null?void 0:i.hp)||0}function Y(t){var i;return((i=J[t])==null?void 0:i.atk)||0}function ee(t){var i;return((i=J[t])==null?void 0:i.heal)||0}function te(t){var i;return((i=J[t])==null?void 0:i.conHeal)||0}const mt={"ATKUP(極小)":1.1,"ATKUP(小)":1.2,"ATKUP(中)":1.35,"ATKUP(大)":1.5,"ATKUP(極大)":1.8},ct={"ダメUP(極小)":.025,"ダメUP(小)":.05,"ダメUP(中)":.0875,"ダメUP(大)":.125,"ダメUP(極大)":.1875,"属性ダメUP(極小)":.03,"属性ダメUP(小)":.06,"属性ダメUP(中)":.1005,"属性ダメUP(大)":.15,"属性ダメUP(極大)":.27},ae={};function lt(t,i,u,n){const c=`${t},${i},${u},${n}`;if(c in ae)return ae[c];let d=i.includes("弱")?.75:1;d*=u==="無"?1.1:1,d+=ct[t]||0;let v=1;(i=="連撃(弱)"||i=="連撃(強)")&&(v=1.8),(i=="デュオ魔法"||i=="3連撃(弱)")&&(v=2.4);const k=n*d*v;return ae[c]=k,k}function ie(t,i,u,n,c){return n=(mt[t]||1)*n+n*c,lt(t,i,u=="無"?"無":"無以外",n)}function z(t,i,u){const n=[t,i,u];return n.sort((c,d)=>d-c),[n[0],n[1]]}function ut(t){const i=new Set;for(const e of t)i.add(e.chara);if(!Array.from(at.value).every(e=>i.has(e)))return;let n=0,c=0,d=0,v=0,k=0,j=0,E=0,T=0,h=0,L=0,M=0,f=0,K=0,a=99999;const r=[],o=[],l=[],g=[],_=[];let D=0,S=0,C=0,U=0,F=0;const A={},x={},R={},re=[];let ne="";const b=[],me=[],ce=[],le=[],ue=[],fe=[],ge=[];t.sort((e,s)=>s.calcBaseATK-e.calcBaseATK),t.forEach((e,s)=>{A[s]=!1,x[s]=!1,R[s]=!1});function W(e,s){let y=0;return e.magic1atr==s&&(y+=1),e.magic2atr==s&&(y+=1),e.magic3atr==s&&e.hasM3&&(y+=1),Math.min(y,2)}if(t.forEach((e,s)=>{re.push(e.imgUrl),ne+="&name"+(s+1)+"="+e.name,n+=e.calcBaseHP,E+=e.buff_count,T+=e.debuff_count,L+=W(e,"無"),M+=W(e,"火"),f+=W(e,"水"),K+=W(e,"木");let y=!1,V=0,N=0;if(i.has(e.buddy1c)){k+=1;const p=X(e.buddy1s);V+=Y(e.buddy1s),p!=0&&(v+=1,y=!0,n+=e.calcBaseHP*p,N+=e.calcBaseHP*p)}if(i.has(e.buddy2c)){k+=1;const p=X(e.buddy2s);V+=Y(e.buddy2s),p!=0&&(v+=1,y=!0,n+=e.calcBaseHP*p,N+=e.calcBaseHP*p)}if(i.has(e.buddy3c)){k+=1;const p=X(e.buddy3s);V+=Y(e.buddy3s),p!=0&&(v+=1,y=!0,n+=e.calcBaseHP*p,N+=e.calcBaseHP*p)}a=Math.min(a,N);const de=(ee(e.magic1heal)+ee(e.magic2heal)+(e.hasM3?ee(e.magic3heal):0))*e.calcBaseATK,pe=(te(e.magic1heal)+te(e.magic2heal)+(e.hasM3?te(e.magic3heal):0))*e.calcBaseHP;c+=de+pe,me.push(de+pe),d+=e.evasion,y||(j+=1);let G=e.magic2pow;if(R[s])G="デュオ",h+=1;else{if(!R[s]){for(const[p,O]of t.entries())if(O.duo==e.chara&&e.duo==O.chara&&!R[s]&&!R[p]){R[s]=!0,R[p]=!0,A[s]=!0,A[p]=!0;break}if(!A[s]){for(const[p,O]of t.entries())if(e.duo==O.chara&&!R[s]&&!A[s]&&!x[p]){R[s]=!0,A[s]=!0,x[p]=!0;break}}if(!A[s]){for(const[p,O]of t.entries())if(e.duo==O.chara&&!R[s]&&!A[s]&&!A[p]){R[s]=!0,A[s]=!0,A[p]=!0;break}}}R[s]&&(G="デュオ",h+=1)}const B=ie(e.magic1buf,e.magic1pow,e.magic1atr,e.calcBaseATK,V),w=ie(e.magic2buf,G,e.magic2atr,e.calcBaseATK,V),I=e.hasM3?ie(e.magic3buf,e.magic3pow,e.magic3atr,e.calcBaseATK,V):0,Ae=e.magic1atr=="無"?B:B*1.5,ke=e.magic2atr=="無"?w:w*1.5,Ee=e.magic3atr=="無"?I:I*1.5,ye=H(e.magic1atr,"火",B),He=H(e.magic2atr,"火",w),Te=H(e.magic3atr,"火",I),he=H(e.magic1atr,"水",B),Le=H(e.magic2atr,"水",w),be=H(e.magic3atr,"水",I),Ve=H(e.magic1atr,"木",B),Be=H(e.magic2atr,"木",w),we=H(e.magic3atr,"木",I);r.push(...z(B,w,I)),o.push(...z(Ae,ke,Ee)),l.push(...z(ye,He,Te)),g.push(...z(he,Le,be)),_.push(...z(Ve,Be,we)),ce.push(r.at(-1)+r.at(-2)),le.push(o.at(-1)+o.at(-2)),ue.push(l.at(-1)+l.at(-2)),fe.push(g.at(-1)+g.at(-2)),ge.push(_.at(-1)+_.at(-2))}),D=r.sort((e,s)=>s-e).slice(0,q.value).reduce((e,s)=>e+s,0),S=o.sort((e,s)=>s-e).slice(0,q.value).reduce((e,s)=>e+s,0),C=l.sort((e,s)=>s-e).slice(0,q.value).reduce((e,s)=>e+s,0),U=g.sort((e,s)=>s-e).slice(0,q.value).reduce((e,s)=>e+s,0),F=_.sort((e,s)=>s-e).slice(0,q.value).reduce((e,s)=>e+s,0),!(n<Ue.value)&&!(n+c<Ce.value)&&!(v<ze.value)&&!(a<je.value)&&!(d<We.value)&&!(h<Ne.value)&&!(E<qe.value)&&!(T<Fe.value)&&!(L<$e.value)&&!(M<Je.value)&&!(f<xe.value)&&!(K<Ge.value)&&!(D<Ze.value)&&!(S<Qe.value)&&!(C<Xe.value)&&!(U<et.value)&&!(F<Ye.value))return D=Math.floor(D),S=Math.floor(S),C=Math.floor(C),U=Math.floor(U),F=Math.floor(F),a=Math.floor(a),b.push(me),b.push(ce),b.push(le),b.push(ue),b.push(fe),b.push(ge),[n,n+c,d,v,a,k,j,h,E,T,L,M,f,K,D,S,C,U,F,...re,ne,b]}const ft={水:{火:1.5,木:.5},木:{水:1.5,火:.5},火:{木:1.5,水:.5}};function H(t,i,u){var c;const n=(c=ft[t])==null?void 0:c[i];return n?u*n:u}function Pe(t){return function(i,u){for(let n=0;n<t.length;n++){const{key:c,order:d}=t[n];if(!Object.prototype.hasOwnProperty.call(i,c)||!Object.prototype.hasOwnProperty.call(u,c))continue;let v=0;if(i[c]<u[c]?v=-1:i[c]>u[c]&&(v=1),v!==0)return d==="降順"?v*-1:v}return 0}}function oe(t){return t<=0?1:t*oe(t-1)}async function Dt(t){for(const a of Z.value)if(a.required&&a.level==0){Q.value=t("error.requiredCharacter");return}const i=Z.value.filter(a=>a.level>0).map(a=>({...a,calcBaseHP:0,calcBaseATK:0})),u=Z.value.filter(a=>a.rare=="SSR").map(a=>({...a,calcBaseHP:0,calcBaseATK:0}));i.forEach(a=>{let r=110;a.rare=="SR"?r=90:a.rare=="R"&&(r=70);const o=a.base_hp*.2,l=a.base_atk*.2,g=(a.hp-2*o-a.base_hp)/(r-1),_=(a.atk-2*l-a.base_atk)/(r-1),D=r-a.level;a.calcBaseHP=a.hp-g*D,a.calcBaseATK=a.atk-_*D}),u.forEach(a=>{a.calcBaseHP=a.hp,a.calcBaseATK=a.atk});const n=i.length;if(n<5){Q.value=t("error.fewCharacter");return}ve.value=0;const c=rt(t),d=[];for(const a of tt.value)for(let r=0;r<c.length;r++)if(c[r]==a.prop){let o="降順";switch(a.order){case"ASC":o="昇順";break;case"DESC":o="降順";break;case"昇順":case"降順":o=a.order;break;default:continue}d.push({key:nt[r],order:o})}const v=d[0].order==="昇順";async function k(){P.value.sort(Pe(d));const a=P.value.slice(0,_e.value);P.value=[...a],P.value.length>0&&(T=P.value[P.value.length-1][d[0].key]),await new Promise(requestAnimationFrame)}const j=new Set(["referenceDamage","referenceAdvantageDamage","referenceVsHiDamage","referenceVsMizuDamage","referenceVsKiDamage"]);d[0].key in j?i.sort((a,r)=>a.required&&!r.required?-1:!a.required&&r.required?1:r.calcBaseATK-a.calcBaseATK):i.sort((a,r)=>a.required&&!r.required?-1:!a.required&&r.required?1:r.calcBaseHP-a.calcBaseHP);const E=i.filter(a=>a.required).length;if(E>5){Q.value="必須設定されたキャラが多すぎます";return}P.value=[];let T=d[0].order==="昇順"?1/0:-1/0;const h=async a=>new Promise(r=>{const o=ut(a);if(o){const l={hp:Math.round(o[0]),ehp:Math.round(o[1]),evasion:o[2],hpBuddy:o[3],increasedHpBuddy:o[4],buddy:o[5],noHpBuddy:o[6],duo:o[7],buff:o[8],debuff:o[9],maxCosmic:o[10],maxFire:o[11],maxWater:o[12],maxFlora:o[13],referenceDamage:o[14],referenceAdvantageDamage:o[15],referenceVsHiDamage:o[16],referenceVsMizuDamage:o[17],referenceVsKiDamage:o[18],chara1:o[19],chara2:o[20],chara3:o[21],chara4:o[22],chara5:o[23],simuURL:o[24],detailList:o[25]},g=l[d[0].key];(v&&g<=T||!v&&g>=T)&&P.value.push(l)}ve.value+=1,r()}),L=async(a,r,o,l,g)=>{const _=[i[a],i[r],i[o],i[l],i[g]];await h(_)},M=async(a,r,o,l,g)=>{const _=[i[a],i[r],i[o],i[l],u[g]];await h(_)},f=new Array(5).fill(n);for(let a=0;a<E;a++)f[a]=a+1;if(it.value){let a=Date.now();const r=f[0]*(f[1]-1)*(f[2]-2)*(f[3]-3);if($.value=r*u.length/oe(4-E),E==5){$.value=1,await L(0,1,2,3,4),await new Promise(requestAnimationFrame);return}for(let o=0;o<f[0];o++)for(let l=o+1;l<f[1];l++)for(let g=l+1;g<f[2];g++){if(!De.value)return;for(let _=g+1;_<f[3];_++)for(let D=0;D<u.length;D++)await M(o,l,g,_,D),Date.now()-a>2e3&&(a=Date.now(),await k())}}else{const a=f[0]*(f[1]-1)*(f[2]-2)*(f[3]-3);if($.value=a*(f[4]-4)/oe(5-E),E==5){$.value=1,await L(0,1,2,3,4),await new Promise(requestAnimationFrame);return}let r=Date.now();for(let o=0;o<f[0];o++)for(let l=o+1;l<f[1];l++)for(let g=l+1;g<f[2];g++){if(!De.value)return;for(let _=g+1;_<f[3];_++)for(let D=_+1;D<f[4];D++)await L(o,l,g,_,D),Date.now()-r>2e3&&(r=Date.now(),await k())}}P.value.sort(Pe(d));const K=P.value.slice(0,_e.value);P.value=[...K],P.value.length>0&&(T=P.value[P.value.length-1][d[0].key])}async function Pt(t){const i={};return await Promise.all(t.map(u=>Oe(Object.assign({"../assets/img/icon/ace.png":()=>m(()=>import("./ace-34f83527.js"),[],import.meta.url),"../assets/img/icon/azul.png":()=>m(()=>import("./azul-104d0980.js"),[],import.meta.url),"../assets/img/icon/cater.png":()=>m(()=>import("./cater-b85b6103.js"),[],import.meta.url),"../assets/img/icon/cosmic.png":()=>m(()=>import("./cosmic-a59dc59f.js"),[],import.meta.url),"../assets/img/icon/crewel.png":()=>m(()=>import("./crewel-6ab42db2.js"),[],import.meta.url),"../assets/img/icon/crowley.png":()=>m(()=>import("./crowley-fd99c5d0.js"),[],import.meta.url),"../assets/img/icon/deuce.png":()=>m(()=>import("./deuce-2352262f.js"),[],import.meta.url),"../assets/img/icon/epel.png":()=>m(()=>import("./epel-0faa9669.js"),[],import.meta.url),"../assets/img/icon/fellow.png":()=>m(()=>import("./fellow-a00d75c7.js"),[],import.meta.url),"../assets/img/icon/fire.png":()=>m(()=>import("./fire-49f6afc2.js"),[],import.meta.url),"../assets/img/icon/flora.png":()=>m(()=>import("./flora-816b4821.js"),[],import.meta.url),"../assets/img/icon/floyd.png":()=>m(()=>import("./floyd-368ab9db.js"),[],import.meta.url),"../assets/img/icon/grim.png":()=>m(()=>import("./grim-724f2176.js"),[],import.meta.url),"../assets/img/icon/idia.png":()=>m(()=>import("./idia-31cb1427.js"),[],import.meta.url),"../assets/img/icon/jack.png":()=>m(()=>import("./jack-23267685.js"),[],import.meta.url),"../assets/img/icon/jade.png":()=>m(()=>import("./jade-561d2cbc.js"),[],import.meta.url),"../assets/img/icon/jamil.png":()=>m(()=>import("./jamil-34a1eb2e.js"),[],import.meta.url),"../assets/img/icon/kalim.png":()=>m(()=>import("./kalim-65c834c5.js"),[],import.meta.url),"../assets/img/icon/leona.png":()=>m(()=>import("./leona-536d417e.js"),[],import.meta.url),"../assets/img/icon/lilia.png":()=>m(()=>import("./lilia-7ddfbf2f.js"),[],import.meta.url),"../assets/img/icon/malleus.png":()=>m(()=>import("./malleus-d8a8aef9.js"),[],import.meta.url),"../assets/img/icon/ortho.png":()=>m(()=>import("./ortho-b307a73d.js"),[],import.meta.url),"../assets/img/icon/riddle.png":()=>m(()=>import("./riddle-bb106fb0.js"),[],import.meta.url),"../assets/img/icon/rollo.png":()=>m(()=>import("./rollo-abfad1a5.js"),[],import.meta.url),"../assets/img/icon/rook.png":()=>m(()=>import("./rook-08b4c270.js"),[],import.meta.url),"../assets/img/icon/ruggie.png":()=>m(()=>import("./ruggie-825bc723.js"),[],import.meta.url),"../assets/img/icon/sebek.png":()=>m(()=>import("./sebek-d7f9f410.js"),[],import.meta.url),"../assets/img/icon/silver.png":()=>m(()=>import("./silver-6b693d48.js"),[],import.meta.url),"../assets/img/icon/train.png":()=>m(()=>import("./train-f5efeb27.js"),[],import.meta.url),"../assets/img/icon/trey.png":()=>m(()=>import("./trey-16a59558.js"),[],import.meta.url),"../assets/img/icon/vil.png":()=>m(()=>import("./vil-5fff0695.js"),[],import.meta.url),"../assets/img/icon/water.png":()=>m(()=>import("./water-8e4cbf0d.js"),[],import.meta.url)}),`../assets/img/icon/${u.name_en}.png`).then(n=>{i[u.name_en]=n.default}).catch(()=>{i[u.name_en]=""}))),i}export{Dt as a,Me as b,pt as c,_t as d,vt as e,Pt as f,rt as g,Ke as u};
